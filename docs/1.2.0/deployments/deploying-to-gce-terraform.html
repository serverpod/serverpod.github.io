<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-1.2.0 docs-doc-page docs-doc-id-deployments/deploying-to-gce-terraform" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.6.3">
<title data-rh="true">Google Cloud Engine with Terraform | Serverpod</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://serverpod.github.io/1.2.0/deployments/deploying-to-gce-terraform"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="1.2.0"><meta data-rh="true" name="docusaurus_tag" content="docs-default-1.2.0"><meta data-rh="true" name="docsearch:version" content="1.2.0"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-1.2.0"><meta data-rh="true" property="og:title" content="Google Cloud Engine with Terraform | Serverpod"><meta data-rh="true" name="description" content="Serverpod makes deploying your server to Cloud Engine easy using Github, Terraform, and Docker containers. Terraform will set up and manage your infrastructure while you use Github to build your Docker container and manage versions and deployments. Creating your project using serverpod create will automatically generate your deployment scripts. The default setup creates a minimal configuration, but you can easily modify the configuration to suit your needs."><meta data-rh="true" property="og:description" content="Serverpod makes deploying your server to Cloud Engine easy using Github, Terraform, and Docker containers. Terraform will set up and manage your infrastructure while you use Github to build your Docker container and manage versions and deployments. Creating your project using serverpod create will automatically generate your deployment scripts. The default setup creates a minimal configuration, but you can easily modify the configuration to suit your needs."><link data-rh="true" rel="icon" href="/img/favicon.png"><link data-rh="true" rel="canonical" href="https://serverpod.github.io/1.2.0/deployments/deploying-to-gce-terraform"><link data-rh="true" rel="alternate" href="https://serverpod.github.io/1.2.0/deployments/deploying-to-gce-terraform" hreflang="en"><link data-rh="true" rel="alternate" href="https://serverpod.github.io/1.2.0/deployments/deploying-to-gce-terraform" hreflang="x-default"><script src="https://widget.kapa.ai/kapa-widget.bundle.js" data-website-id="9ae02024-c2cf-4f58-b2d9-7ca3961dc1ef" data-project-name="Serverpod" data-project-color="#020F24" data-project-logo="https://avatars.githubusercontent.com/u/48181558?s=200&amp;v=4" async></script><link rel="stylesheet" href="/assets/css/styles.c77738bc.css">
<script src="/assets/js/runtime~main.58a82c4c.js" defer="defer"></script>
<script src="/assets/js/main.502747fc.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();null!==e?t(e):window.matchMedia("(prefers-color-scheme: dark)").matches?t("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,t("light"))}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a href="https://serverpod.dev" target="_blank" rel="noopener noreferrer" class="navbar__brand"><div class="navbar__logo"><img src="/img/logo-horizontal.svg" alt="Serverpod Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo-horizontal-dark.svg" alt="Serverpod Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div></a><div class="navbar__item dropdown dropdown--hoverable"><a aria-current="page" class="navbar__link active" aria-haspopup="true" aria-expanded="false" role="button" href="/1.2.0/deployments/deploying-to-gce-terraform">1.2.0</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/next/deployments/deploying-to-gce-terraform">Next</a></li><li><a class="dropdown__link" href="/deployments/deploying-to-gce-terraform">2.3.0</a></li><li><a class="dropdown__link" href="/2.2.0/deployments/deploying-to-gce-terraform">2.2.0</a></li><li><a class="dropdown__link" href="/2.1.0/deployments/deploying-to-gce-terraform">2.1.0</a></li><li><a class="dropdown__link" href="/2.0.0/deployments/deploying-to-gce-terraform">2.0.0</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/1.2.0/deployments/deploying-to-gce-terraform">1.2.0</a></li><li><a class="dropdown__link" href="/1.1.1/deployments/deploying-to-gce-terraform">1.1.1</a></li><li><a class="dropdown__link" href="/1.1.0/deployments/deploying-to-gce-terraform">1.1.0</a></li><li><a class="dropdown__link" href="/1.0.0">1.0.0</a></li><li><a class="dropdown__link" href="/0.9.22">0.9.22</a></li><li><a class="dropdown__link" href="/0.9.21">0.9.21</a></li><li><a class="dropdown__link" href="/0.9.20">0.9.20</a></li><li><a class="dropdown__link" href="/0.9.11">0.9.11</a></li><li><a class="dropdown__link" href="/0.9.10">0.9.10</a></li><li><a class="dropdown__link" href="/0.9.9">0.9.9</a></li><li><a class="dropdown__link" href="/0.9.8">0.9.8</a></li><li><a class="dropdown__link" href="/0.9.7">0.9.7</a></li><li><a class="dropdown__link" href="/0.9.6">0.9.6</a></li><li><a class="dropdown__link" href="/0.9.5">0.9.5</a></li></ul></div></div><div class="navbar__items navbar__items--right"><a href="https://pub.dev/documentation/serverpod/latest/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">API reference<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://careers.serverpod.dev/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Career<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://twitter.com/ServerpodDev" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://github.com/serverpod/serverpod" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="navbarSearchContainer_Bca1"></div><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/1.2.0">Installing Serverpod</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/1.2.0/get-started">Get started</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/1.2.0/capabilities">Capabilities</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="true" href="/1.2.0/tutorials/first-app">Tutorials</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/1.2.0/tutorials/first-app">Build your first app</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/1.2.0/tutorials/videos">Videos</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/1.2.0/tutorials/code-example">Code examples</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/1.2.0/tutorials/authentication">Authentication</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/1.2.0/support">Support &amp; community</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="true" href="/1.2.0/concepts/working-with-endpoints">Concepts</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/1.2.0/concepts/working-with-endpoints">Working with endpoints</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/1.2.0/concepts/models">Working with models</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/1.2.0/concepts/serialization">Custom serialization</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/1.2.0/concepts/exceptions">Error handling and exceptions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/1.2.0/concepts/sessions">Sessions</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/1.2.0/concepts/database/connection">Database</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/1.2.0/concepts/caching">Caching</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/1.2.0/concepts/logging">Logging</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/1.2.0/concepts/modules">Modules</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/1.2.0/concepts/authentication/setup">Authentication</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/1.2.0/concepts/file-uploads">Uploading files</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/1.2.0/concepts/health-checks">Health checks</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/1.2.0/concepts/scheduling">Scheduling</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/1.2.0/concepts/streams">Streams and messaging</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/1.2.0/concepts/backward-compatibility">Backward compatibility</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/1.2.0/concepts/webserver">Web server</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/1.2.0/deployments/deployment-strategy">Deploying Serverpod</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/1.2.0/deployments/deployment-strategy">Choosing deployment strategy</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/1.2.0/deployments/deploying-to-gce-terraform">Google Cloud Engine with Terraform</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/1.2.0/deployments/deploying-to-gcr-console">Google Cloud Run with CGP Console</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/1.2.0/deployments/deploying-to-aws">AWS EC2 with Terraform</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/1.2.0/deployments/general">Hosting elsewhere</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/1.2.0/cli">Serverpod CLI</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/1.2.0/insights">Serverpod Insights</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/1.2.0/lsp">Serverpod LSP</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/1.2.0/roadmap">Roadmap</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/1.2.0/contribute">Contribute</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/1.2.0/upgrading/upgrade-to-one-point-two">Upgrading</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="theme-doc-version-banner alert alert--warning margin-bottom--md" role="alert"><div>This is documentation for <!-- -->Serverpod<!-- --> <b>1.2.0</b>, which is no longer actively maintained.</div><div class="margin-top--md">For up-to-date documentation, see the <b><a href="/deployments/deploying-to-gce-terraform">latest version</a></b> (<!-- -->2.3.0<!-- -->).</div></div><div class="docItemContainer_Djhp"><article><span class="theme-doc-version-badge badge badge--secondary">Version: 1.2.0</span><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Google Cloud Engine with Terraform</h1></header>
<p>Serverpod makes deploying your server to Cloud Engine easy using Github, Terraform, and Docker containers. Terraform will set up and manage your infrastructure while you use Github to build your Docker container and manage versions and deployments. Creating your project using <code>serverpod create</code> will automatically generate your deployment scripts. The default setup creates a minimal configuration, but you can easily modify the configuration to suit your needs.</p>
<div class="theme-admonition theme-admonition-caution admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>caution</div><div class="admonitionContent_BuS1"><p>Using Serverpod&#x27;s GCP deployment may incur costs to your GCP account. Serverpod&#x27;s scripts are provided as-is, and we take no responsibility for any unexpected charges for using them.</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="prerequisites">Prerequisites<a href="#prerequisites" class="hash-link" aria-label="Direct link to Prerequisites" title="Direct link to Prerequisites">​</a></h2>
<p>To use the deployment scripts, you will need the following:</p>
<ol>
<li>A paid Google Cloud Platform account.</li>
<li>Terraform <a href="https://developer.hashicorp.com/terraform/tutorials/gcp-get-started/install-cli" target="_blank" rel="noopener noreferrer">Install Terraform</a></li>
<li>Your Serverpod project version controlled on Github.</li>
<li>A registered custom domain name (e.g., examplepod.com), or register one through <em>Cloud Domains</em> in the GCP console.</li>
</ol>
<p>If you haven&#x27;t used Terraform before, it&#x27;s a great idea to go through their tutorial for GCP, as it will give you a basic understanding of how everything fits together. <a href="https://developer.hashicorp.com/terraform/tutorials/gcp-get-started" target="_blank" rel="noopener noreferrer">Get started with Terraform and GCP</a></p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_BuS1"><p>The top directory created by Serverpod must be the root directory of your Git repository. Otherwise, the deployment scripts won&#x27;t work correctly.</p></div></div>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_BuS1"><p>Registering your domain through Cloud Domains in the GCP console allows you to create a hosted zone simultaneously. It also makes it easier to verify your domain, and you can skip a few of the steps below. If you use Cloud Domains, register the domain after the step where you create your service account.</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="what-will-be-deployed">What will be deployed?<a href="#what-will-be-deployed" class="hash-link" aria-label="Direct link to What will be deployed?" title="Direct link to What will be deployed?">​</a></h2>
<p>The deployment scripts will set up everything you need to run your Serverpod, including an autoscaling cluster of servers, a load balancer, a Postgres database, Redis (optional), Cloud Storage buckets for file uploads, Artifact Registry for your Docker container, a private network, DNS records, and SSL certificates. Some of the components are optional, and you will need to opt in. You can also create a second server cluster for a staging environment. Staging servers allow you to test your code before you deploy it to the production servers.</p>
<p>You deploy your configuration with a domain name; the scripts will set up subdomains that provide access to different functions of your deployment:</p>
<ul>
<li><em>api.examplepod.com</em>: This is the entry point for your Serverpod&#x27;s API server.</li>
<li><em>app.examplepod.com</em>: The Serverpod web server. If you prefer to host it on your top domain and use <em>www</em> as a redirect, you can change this in the main Terraform configuration file.</li>
<li><em>insights.examplepod.com</em>: Provides an access point to Serverpod Insights, Serverpod&#x27;s companion app.</li>
<li><em>database.examplepod.com</em>: This is how you access your database from outside the server.</li>
<li><em>storage.examplepod.com</em>: Access to public storage used by Serverpod.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="create-a-new-gcp-project-with-a-service-account">Create a new GCP project with a service account<a href="#create-a-new-gcp-project-with-a-service-account" class="hash-link" aria-label="Direct link to Create a new GCP project with a service account" title="Direct link to Create a new GCP project with a service account">​</a></h2>
<p>Your deployment will live in a new GCP project that you create. Sign in to your <a href="https://console.cloud.google.com/" target="_blank" rel="noopener noreferrer">Google Cloud Console</a>, click the project selector and then the <em>New Project</em> button. Enter the name of your new project and take note of the <em>Project ID</em>; you will need it when setting up your deployment scripts.</p>
<p><img decoding="async" loading="lazy" alt="Create GCP Project" src="/assets/images/0-create-project-8ffb3fac5b8ca642f58aab2258a9bbdd.jpg" width="560" height="370" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="create-service-account">Create service account<a href="#create-service-account" class="hash-link" aria-label="Direct link to Create service account" title="Direct link to Create service account">​</a></h3>
<p>Next, you must create a service account allowing Terraform to access your account and set up the infrastructure for your Serverpod.</p>
<p>Select your newly created project if it isn&#x27;t already selected. Then, navigate to <em>IAM &amp; Admin</em> &gt; <em>Service Accounts</em>. Click on the <em>Create Service Account</em> button.</p>
<p>Enter a name for your service account and take note of the email address associated with it. Click <em>Create and Continue</em>.</p>
<p>Next, you will need to add two roles to your service account. <em>Basic</em> &gt; <em>Editor</em> and <em>Service Networking</em> &gt; <em>Service Networking Admin</em>. These permissions will give Terraform the access it needs to create your infrastructure. When you&#x27;ve added the permissions, click <em>Continue</em>.</p>
<p><img decoding="async" loading="lazy" alt="Assign roles to the service account" src="/assets/images/1-assign-roles-3127957a46184bad6a5e2d38f6d458c0.jpg" width="576" height="667" class="img_ev3q"></p>
<p>Finally, click <em>Done</em> to finalize the service account creation.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="download-service-account-keys">Download service account keys<a href="#download-service-account-keys" class="hash-link" aria-label="Direct link to Download service account keys" title="Direct link to Download service account keys">​</a></h3>
<p>To be able to use your service account with Terraform, you will need to create a set of keys. Click on your newly created service account, then select the <em>Keys</em> tab. Click <em>Add Key</em> &gt; <em>Create a New Key</em>. Select <em>JSON</em> as the key type and click <em>Create</em>.</p>
<p><img decoding="async" loading="lazy" alt="Create private keys" src="/assets/images/2-private-key-3ee06ba2b0f99e42a91388d62f71ae2f.jpg" width="610" height="411" class="img_ev3q"></p>
<p>The key is now downloaded to your computer. Rename the key to <code>credentials.json</code> and place it in your Serverpod&#x27;s server directory under <code>deploy/gcp/terraform_gce</code>. E.g., the whole path would be something like <code>myproject_server/deploy/gcp/terraform_gce/credentials.json</code>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="enabling-apis">Enabling APIs<a href="#enabling-apis" class="hash-link" aria-label="Direct link to Enabling APIs" title="Direct link to Enabling APIs">​</a></h3>
<p>To deploy your serverpod, you must enable a set of APIs on Google Cloud. You can find which APIs are enabled or enable new ones by going to <em>APIs &amp; Services</em> &gt; <em>Enabled APIs &amp; Services</em>. These are the APIs that you should enable:</p>
<ul>
<li>Artifact Registry API  (artifactregistry.googleapis.com)</li>
<li>Certificate Manager API (certificatemanager.googleapis.com)</li>
<li>Cloud DNS API (dns.googleapis.com)</li>
<li>Cloud Resource Manager API (cloudresourcemanager.googleapis.com)</li>
<li>Cloud SQL Admin API (sqladmin.googleapis.com)</li>
<li>Compute Engine API (compute.googleapis.com)</li>
<li>Service Networking API (servicenetworking.googleapis.com)</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="set-up-your-domain-name">Set up your domain name<a href="#set-up-your-domain-name" class="hash-link" aria-label="Direct link to Set up your domain name" title="Direct link to Set up your domain name">​</a></h2>
<p>The Terraform script automatically handles your subdomains, but you must manually set up your domain zone in Google Cloud Console. This setup is also helpful if you want to add other things to your domain, such as email, or associate your domain with a website not hosted by Serverpod.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="register-your-domain">Register your domain<a href="#register-your-domain" class="hash-link" aria-label="Direct link to Register your domain" title="Direct link to Register your domain">​</a></h3>
<p><strong>If you already have a domain that you want to use, you should skip this step and continue at: <a href="#create-a-dns-zone">Create a DNS zone</a></strong></p>
<p>Start by activating the required APIs for managing your domain. First, navigate to <em>Network services</em> &gt; <em>Cloud DNS</em> and activate the service. Then navigate to <em>Network services</em> &gt; <em>Cloud Domains</em> and activate it.</p>
<p>Once <em>Cloud Domains</em> is active, click the <em>Register Domain</em> button. Search for the domain name you want to use and add it to your cart.</p>
<p>In the DNS configuration, let Google&#x27;s DNS servers manage the domain and connect it to a new DNS zone. Follow the steps to verify your email with Google Domains if needed.</p>
<p>Your domain will automatically be verified with Google, but you must add your service account email as verified by Google&#x27;s Webmaster Central. This step is required to be able to create SSL certificates for your domain.</p>
<p>Go to the Google Webmaster Central: <a href="https://www.google.com/webmasters/verification" target="_blank" rel="noopener noreferrer">https://www.google.com/webmasters/verification</a></p>
<p>Select your newly registered domain. Then, click <em>Add an owner</em>. Enter the email from the service account that you created earlier.</p>
<p>Now, skip ahead to <a href="#deploy-your-serverpod-code">Deploy your Serverpod code</a></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="create-a-dns-zone">Create a DNS zone<a href="#create-a-dns-zone" class="hash-link" aria-label="Direct link to Create a DNS zone" title="Direct link to Create a DNS zone">​</a></h3>
<p>Go to <em>Network Services</em> &gt; <em>Cloud DNS</em>, then click <em>Create Zone</em>. Create a public zone for your domain name. Take note of the name you assign to the domain name zone, you will need it when you configure the Terraform scripts.</p>
<p><img decoding="async" loading="lazy" alt="Create DNS zone" src="/assets/images/3-dns-zone-b2b3cbaf4ef028b26df791ae4ee486ea.jpg" width="557" height="702" class="img_ev3q"></p>
<p>To make the domain accessible, you must configure your registrar so that it points your domain to Google&#x27;s domain name servers. Click the <em>NS</em> entry to reveal the domain name servers to which you should point your domain.</p>
<p>Now, head over to your domain name registrar and point the domain to Google&#x27;s domain name servers. The domain name servers can take a while to update (worst case, up to a day, but it is usually much faster).</p>
<p><img decoding="async" loading="lazy" alt="Configure domain registrar" src="/assets/images/4-dns-forward-5a0d4b8dfd116ab0ba2a2a177cdd140e.jpg" width="546" height="211" class="img_ev3q"></p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_BuS1"><p>Depending on your domain name registrar, the process for setting up your domain name servers may look slightly different. Also, note that the Google servers may have different names than those shown in the screenshot.</p></div></div>
<p>You can test that the domain points to the correct name servers by running <code>dig</code> on the command line. It will output the domain name servers.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">dig</span><span class="token plain"> +short NS examplepod.com</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Should yield an output similar to this:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ns-cloud-b4.googledomains.com.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ns-cloud-b1.googledomains.com.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ns-cloud-b2.googledomains.com.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ns-cloud-b3.googledomains.com.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="verify-your-domain">Verify your domain<a href="#verify-your-domain" class="hash-link" aria-label="Direct link to Verify your domain" title="Direct link to Verify your domain">​</a></h3>
<p>Once your domain name zone is set up and has bubbled through the system, you must verify the domain with Google&#x27;s Webmaster Central. This step is required to be able to create SSL certificates for your domain.</p>
<p>Go to the Google Webmaster Central:
<a href="https://www.google.com/webmasters/verification" target="_blank" rel="noopener noreferrer">https://www.google.com/webmasters/verification</a></p>
<p>Click on <em>Add a Property</em>, enter your domain name and press <em>Continue</em>. Now click the <em>Alternate methods</em> tab and select <em>Domain name provider</em>. In the list that pops up, select <em>Google Domains</em>. A dialog showing the steps required to verify your domain will pop up. From the dialog, copy the highlighted TXT record.</p>
<p><img decoding="async" loading="lazy" alt="Verify domain in Webmaster Central" src="/assets/images/5-domain-verification-540eb62658d2289a889f266ae9663065.jpg" width="737" height="620" class="img_ev3q"></p>
<p>Now, open your Google Cloud Console and navigate to <em>Network Services</em> &gt; <em>Cloud DNS</em>. Select the DNS zone you created earlier, then click <em>Add Standard</em> to create a new record set. Set the <em>Resource record type</em> to <em>TXT</em>, then paste the code from the Webmaster Central in the <em>TXT data</em> field and create the record set. In the Webmaster Central, you can now finish the verification by clicking <em>Verify</em>.</p>
<p><img decoding="async" loading="lazy" alt="Add DNS record" src="/assets/images/6-record-set-9a2be3ebe9c6489577828d059abd8671.jpg" width="559" height="380" class="img_ev3q"></p>
<p>Finally, click on <em>Add additional owners</em> and add the email from the service account you created earlier. Doing this will allow Terraform to make any required changes to your SSL certificates.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="deploy-your-serverpod-code">Deploy your Serverpod code<a href="#deploy-your-serverpod-code" class="hash-link" aria-label="Direct link to Deploy your Serverpod code" title="Direct link to Deploy your Serverpod code">​</a></h2>
<p>Before creating our infrastructure, we must compile a Docker container with our Serverpod and deploy it to Google Cloud&#x27;s Artifact Registry. The Docker container is compiled on Github and then pushed to the Artifact Registry using a Github action.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="create-artifact-registry-repositories">Create Artifact Registry repositories<a href="#create-artifact-registry-repositories" class="hash-link" aria-label="Direct link to Create Artifact Registry repositories" title="Direct link to Create Artifact Registry repositories">​</a></h3>
<p>Open up the Google Cloud Console and navigate to <em>Artifact Registry</em> &gt; <em>Repositories</em>. Enable the API if needed. Click <em>Create Repository</em>. Set the <em>Name</em> to <code>serverpod-production-container</code>, <em>Format</em> to <em>Docker</em>, and <em>Mode</em> to <em>Standard</em>. Select a <em>Region</em> for your container.</p>
<p><img decoding="async" loading="lazy" alt="Create repository in Artifact Registry" src="/assets/images/7-artifact-repository-406b0863aa48aa3c751b1817e24eed75.jpg" width="562" height="933" class="img_ev3q"></p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_BuS1"><p>The region you pick for your Artifact Registry repository must match the region you later choose for your project. The default is <code>us-central1</code>.</p></div></div>
<p>Repeat the process and create a second container named <code>serverpod-staging-container</code>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="configure-github">Configure Github<a href="#configure-github" class="hash-link" aria-label="Direct link to Configure Github" title="Direct link to Configure Github">​</a></h3>
<p>Now that we have our Artifact Registry repositories, we can push code to it. Head to your Github repository for your project. Navigate to <em>Settings</em> &gt; <em>Secrets and variables</em> &gt; <em>Actions</em>.</p>
<p>Click <em>New repository secret</em>. For the <em>Name</em> enter <code>GOOGLE_CREDENTIALS</code>. For the <em>Secret</em>, copy the contents of the <code>gcp/terraform/credentials.json</code> file and paste its contents into the text field.</p>
<p>Click <em>New repository secret</em> again and enter <code>SERVERPOD_PASSWORDS</code> for the <em>Name</em>. Copy the contents of the <code>config/passwords.yaml</code> file and paste it into the <em>Secret</em> text field.</p>
<p>When you are done, <em>Repository secrets</em> should look like this:</p>
<p><img decoding="async" loading="lazy" alt="Add DNS record" src="/assets/images/8-secrets-d12bd9a1e11015f93c45a5213835f7b2.jpg" width="808" height="218" class="img_ev3q"></p>
<p>Finally, we must configure the Github action that compiles our Docker container. It&#x27;s located in <code>.github/workflows/deployment-gcp.yml</code>. Open it in your favorite editor and update the values under <em>PROJECT</em>, <em>REGION</em>, and <em>ZONE</em> with your <em>Project ID</em> and the zone and region where you plan to deploy your server.</p>
<p>Push your changes to Github, and you are ready to deploy your Docker container.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="deploy-your-docker-container">Deploy your Docker container<a href="#deploy-your-docker-container" class="hash-link" aria-label="Direct link to Deploy your Docker container" title="Direct link to Deploy your Docker container">​</a></h3>
<p>Open your project on Github and navigate to <em>Actions</em>. On the right-hand side, click on the <em>Deploy to GCP</em> item. The action will open up, and you can run it. Click on <em>Run workflow</em>, select the branch where you have pushed your code, set the <em>Target</em> to <em>production</em>, and run the workflow.</p>
<p><img decoding="async" loading="lazy" alt="Run Github workflow" src="/assets/images/9-run-workflow-8d52b13c49684388600682e538b0341a.jpg" width="627" height="453" class="img_ev3q"></p>
<p>It will take a few moments for the workflow to show up and another minute or two to complete. When completed, it should have a green tick mark next to it.</p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_BuS1"><p>In the future, just run the Github action whenever you want to release a new version of your server. You can also trigger the action by pushing code to the <code>deployment-gcp-production</code> or <code>deployment-gcp-staging</code> branches.</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="create-your-infrastructure">Create your infrastructure<a href="#create-your-infrastructure" class="hash-link" aria-label="Direct link to Create your infrastructure" title="Direct link to Create your infrastructure">​</a></h2>
<p>You now have everything you need to start creating your infrastructure. Start by configuring your Terraform scripts, then apply the configuration.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="configure-terraform">Configure Terraform<a href="#configure-terraform" class="hash-link" aria-label="Direct link to Configure Terraform" title="Direct link to Configure Terraform">​</a></h3>
<p>You can find the configuration file for your Terraform project in your server&#x27;s <code>deploy/gcp/terraform_gce/config.auto.tfvars</code> file. It is pretty self-explanatory; you only need to enter your <em>Project ID</em> and the <em>Service account email</em>, the name of your <em>DNS zone</em>, and the <em>domain name</em> you are deploying to. You got the details when completing the steps above, or you can find them in the Google Cloud Console.</p>
<p>If you want to do more detailed configurations, you can do so in the <code>main.tf</code> file. The <code>main.tf</code> file refers to the <code>google_cloud_serverpod_gce</code> module, which handles most of the infrastructure. It contains some comments that explain how to use it, but you can also find the complete documentation <a href="https://github.com/serverpod/google_cloud_serverpod_gce" target="_blank" rel="noopener noreferrer">here</a>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="configure-serverpod">Configure Serverpod<a href="#configure-serverpod" class="hash-link" aria-label="Direct link to Configure Serverpod" title="Direct link to Configure Serverpod">​</a></h3>
<p>Serverpod uses different configuration files depending on whether you run your server locally, in staging, or in production. You find the configuration files in the server&#x27;s <code>config</code> directory. You will need to edit the <code>config/production.yaml</code> file to match your setup. Typically, the only thing you need to change is the name of your domain.</p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_BuS1"><p>If you are deploying a staging server in addition to your production server, you must edit the <code>config/staging.yaml</code> file too.</p></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="deploy-your-infrastructure">Deploy your infrastructure<a href="#deploy-your-infrastructure" class="hash-link" aria-label="Direct link to Deploy your infrastructure" title="Direct link to Deploy your infrastructure">​</a></h3>
<p>Once you have configured Terraform and your Serverpod, you are ready to deploy your infrastructure. Make sure that you have <code>cd</code> into your <code>deploy/gcp/terraform_gce</code> directory. Now run:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ terraform init</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>This will download the Serverpod module and initialize your Terraform configuration. Now, deploy your infrastructure by running:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ terraform apply</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Terraform will ask you for the password to your production and staging database. You will find the passwords in your <code>config/passwords.yaml</code> file. If you are not deploying a staging server, you can leave the staging database password blank.</p>
<p>Answer <code>yes</code> when Terraform asks you if you are ready to perform the changes. Deploying the complete infrastructure will take around 15 minutes, making this an excellent coffee break time.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="create-database-tables">Create database tables<a href="#create-database-tables" class="hash-link" aria-label="Direct link to Create database tables" title="Direct link to Create database tables">​</a></h2>
<p>As a final step in your GCP deployment, you must create your database tables. Terraform has created a database with a public IP number that you can access from <code>database.&lt;your-domain&gt;.com</code>. However, access is limited to connections from specific IP addresses for security reasons.</p>
<p>Open the Google Cloud Console, navigate to <em>SQL</em>, and click on the <code>serverpod-production-database</code> instance. Click <em>Connections</em> &gt; <em>Networking</em>. Under <em>Public IP</em> click <em>Add Network</em>. Enter the name of the place you are connecting from, e.g. <em>Office</em> or <em>Home</em>, then enter your public IP number in the <em>Network</em> field.</p>
<p><img decoding="async" loading="lazy" alt="Add network to database" src="/assets/images/10-add-network-597a480b4780f2781b84cc6f4bb4dae6.jpg" width="562" height="402" class="img_ev3q"></p>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_BuS1"><p>If you are unsure what your public IP number is, Google <code>what is my IP</code>, and Google will tell you.</p></div></div>
<p>Now, you can connect to your database. Use your favorite database managing tool (we use <a href="https://eggerapps.at/postico2/" target="_blank" rel="noopener noreferrer">Postico</a>). To connect, use the password from the <code>config/passwords.yaml</code> file and the public database address (<code>database.&lt;your-domain&gt;.com</code>). For <em>database</em> enter <code>serverpod</code> and <em>user</em> should be set to <code>postgres</code>.</p>
<p><img decoding="async" loading="lazy" alt="Connect to database" src="/assets/images/11-connect-database-c863d169b71bee97b0968b57680ad846.jpg" width="438" height="464" class="img_ev3q"></p>
<p>Once connected, run the database definition query in the latest migration directory <code>migrations/&lt;LATEST_MIGRATION&gt;/definition.sql</code>. When you have added the tables for the database, Serverpod should be able to start. However, it could take an hour before the correct SSL certificates are created and validated.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="deploying-new-versions">Deploying new versions<a href="#deploying-new-versions" class="hash-link" aria-label="Direct link to Deploying new versions" title="Direct link to Deploying new versions">​</a></h2>
<p>Once your infrastructure is set up, deploying new versions of your server code is easy. Push your updated code to Github and run the deployment action. Doing this will compile your code and upload it to the repository in Artifact Registry.</p>
<p>Once your code is uploaded to the Artifact Registry you can restart the servers in your auto scaling group by opening the Google Cloud console and navigating to <em>Compute Engine</em> &gt; <em>Instance Groups</em>. Click on the <em>serverpod-production-group</em>, then <em>Restart/Replace VMs</em>.</p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_BuS1"><p>You can also set up your deployment script on Github to automatically restart the servers when new code is deployed. To do this, uncomment the last section of the script in <code>.github/workflows/deployment-gcp.yml</code>, push the change to Github, and run the action.</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="troubleshooting">Troubleshooting<a href="#troubleshooting" class="hash-link" aria-label="Direct link to Troubleshooting" title="Direct link to Troubleshooting">​</a></h2>
<p>Deploying your infrastructure is somewhat involved, and you can get stuck along the way. These are a few tips on debugging your issues:</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="access-the-instance-logs">Access the instance logs<a href="#access-the-instance-logs" class="hash-link" aria-label="Direct link to Access the instance logs" title="Direct link to Access the instance logs">​</a></h3>
<p>You can find the logs from your running instances by navigating to <em>Compute Engine</em> &gt; <em>VM instances</em>. Click on one of the instances, then click on <em>Logging</em>. It will list the output from starting the instance and logs outputted by the Docker container.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="log-into-the-instance">Log into the instance<a href="#log-into-the-instance" class="hash-link" aria-label="Direct link to Log into the instance" title="Direct link to Log into the instance">​</a></h3>
<p>You can log into your running instances by clicking the small <em>SSH</em> button next to the instance row. For this to work, make sure you have set <code>enable_ssh</code> to <code>true</code> in your Terraform module (this is the default).</p>
<p>Once logged in, you can check that your Docker container is up by running <code>docker ps</code>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="some-things-take-time">Some things take time<a href="#some-things-take-time" class="hash-link" aria-label="Direct link to Some things take time" title="Direct link to Some things take time">​</a></h3>
<p>Some tasks described above can take time to bubble through the system. This is particularly true for working with DNS names and certificates. Sometimes they can take hours or up to a day to update.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="if-you-get-stuck">If you get stuck<a href="#if-you-get-stuck" class="hash-link" aria-label="Direct link to If you get stuck" title="Direct link to If you get stuck">​</a></h3>
<p>You can always find help in our <a href="https://github.com/serverpod/serverpod/discussions" target="_blank" rel="noopener noreferrer">support forum</a> on Github.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/serverpod/serverpod_docs/tree/main/versioned_docs/version-1.2.0/06-deployments/02-deploying-to-gce-terraform.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/1.2.0/deployments/deployment-strategy"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Choosing deployment strategy</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/1.2.0/deployments/deploying-to-gcr-console"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Google Cloud Run with CGP Console</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#prerequisites" class="table-of-contents__link toc-highlight">Prerequisites</a></li><li><a href="#what-will-be-deployed" class="table-of-contents__link toc-highlight">What will be deployed?</a></li><li><a href="#create-a-new-gcp-project-with-a-service-account" class="table-of-contents__link toc-highlight">Create a new GCP project with a service account</a><ul><li><a href="#create-service-account" class="table-of-contents__link toc-highlight">Create service account</a></li><li><a href="#download-service-account-keys" class="table-of-contents__link toc-highlight">Download service account keys</a></li><li><a href="#enabling-apis" class="table-of-contents__link toc-highlight">Enabling APIs</a></li></ul></li><li><a href="#set-up-your-domain-name" class="table-of-contents__link toc-highlight">Set up your domain name</a><ul><li><a href="#register-your-domain" class="table-of-contents__link toc-highlight">Register your domain</a></li><li><a href="#create-a-dns-zone" class="table-of-contents__link toc-highlight">Create a DNS zone</a></li><li><a href="#verify-your-domain" class="table-of-contents__link toc-highlight">Verify your domain</a></li></ul></li><li><a href="#deploy-your-serverpod-code" class="table-of-contents__link toc-highlight">Deploy your Serverpod code</a><ul><li><a href="#create-artifact-registry-repositories" class="table-of-contents__link toc-highlight">Create Artifact Registry repositories</a></li><li><a href="#configure-github" class="table-of-contents__link toc-highlight">Configure Github</a></li><li><a href="#deploy-your-docker-container" class="table-of-contents__link toc-highlight">Deploy your Docker container</a></li></ul></li><li><a href="#create-your-infrastructure" class="table-of-contents__link toc-highlight">Create your infrastructure</a><ul><li><a href="#configure-terraform" class="table-of-contents__link toc-highlight">Configure Terraform</a></li><li><a href="#configure-serverpod" class="table-of-contents__link toc-highlight">Configure Serverpod</a></li><li><a href="#deploy-your-infrastructure" class="table-of-contents__link toc-highlight">Deploy your infrastructure</a></li></ul></li><li><a href="#create-database-tables" class="table-of-contents__link toc-highlight">Create database tables</a></li><li><a href="#deploying-new-versions" class="table-of-contents__link toc-highlight">Deploying new versions</a></li><li><a href="#troubleshooting" class="table-of-contents__link toc-highlight">Troubleshooting</a><ul><li><a href="#access-the-instance-logs" class="table-of-contents__link toc-highlight">Access the instance logs</a></li><li><a href="#log-into-the-instance" class="table-of-contents__link toc-highlight">Log into the instance</a></li><li><a href="#some-things-take-time" class="table-of-contents__link toc-highlight">Some things take time</a></li><li><a href="#if-you-get-stuck" class="table-of-contents__link toc-highlight">If you get stuck</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 Serverpod authors.</div></div></div></footer></div>
</body>
</html>