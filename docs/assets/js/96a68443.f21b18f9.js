"use strict";(self.webpackChunkserverpod_docs=self.webpackChunkserverpod_docs||[]).push([[30480],{12667:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>a,default:()=>h,frontMatter:()=>s,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"concepts/authentication/providers/email/customizing-the-ui","title":"Customizing the UI","description":"When using the email identity provider, you can customize the UI to your liking. You can use the EmailSignInWidget to display the email authentication flow in your own custom UI, or you can use the EmailAuthController to build a completely custom authentication interface.","source":"@site/versioned_docs/version-3.0.0/06-concepts/11-authentication/04-providers/01-email/03-customizing-the-ui.md","sourceDirName":"06-concepts/11-authentication/04-providers/01-email","slug":"/concepts/authentication/providers/email/customizing-the-ui","permalink":"/concepts/authentication/providers/email/customizing-the-ui","draft":false,"unlisted":false,"editUrl":"https://github.com/serverpod/serverpod_docs/tree/main/versioned_docs/version-3.0.0/06-concepts/11-authentication/04-providers/01-email/03-customizing-the-ui.md","tags":[],"version":"3.0.0","sidebarPosition":3,"frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Configuration","permalink":"/concepts/authentication/providers/email/configuration"},"next":{"title":"Admin Operations","permalink":"/concepts/authentication/providers/email/admin-operations"}}');var o=t(74848),r=t(28453);const s={},a="Customizing the UI",l={},c=[{value:"Using the <code>EmailSignInWidget</code>",id:"using-the-emailsigninwidget",level:2},{value:"Customizing the default widget&#39;s appearance",id:"customizing-the-default-widgets-appearance",level:3},{value:"Building a custom UI with the <code>EmailAuthController</code>",id:"building-a-custom-ui-with-the-emailauthcontroller",level:2},{value:"EmailAuthController State Management",id:"emailauthcontroller-state-management",level:3},{value:"The email authentication flow",id:"the-email-authentication-flow",level:2},{value:"Navigating between screens",id:"navigating-between-screens",level:3},{value:"EmailAuthController Methods",id:"emailauthcontroller-methods",level:3},{value:"Login",id:"login",level:4},{value:"Registration Flow",id:"registration-flow",level:4},{value:"Password Reset Flow",id:"password-reset-flow",level:4},{value:"Resending Verification Codes",id:"resending-verification-codes",level:3}];function d(e){const n={admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.header,{children:(0,o.jsx)(n.h1,{id:"customizing-the-ui",children:"Customizing the UI"})}),"\n",(0,o.jsxs)(n.p,{children:["When using the email identity provider, you can customize the UI to your liking. You can use the ",(0,o.jsx)(n.code,{children:"EmailSignInWidget"})," to display the email authentication flow in your own custom UI, or you can use the ",(0,o.jsx)(n.code,{children:"EmailAuthController"})," to build a completely custom authentication interface."]}),"\n",(0,o.jsxs)(n.admonition,{type:"info",children:[(0,o.jsxs)(n.p,{children:["The ",(0,o.jsx)(n.code,{children:"SignInWidget"})," uses the ",(0,o.jsx)(n.code,{children:"EmailSignInWidget"})," internally to display the email authentication flow. You can also supply a custom ",(0,o.jsx)(n.code,{children:"EmailSignInWidget"})," to the ",(0,o.jsx)(n.code,{children:"SignInWidget"})," to override the default behavior."]}),(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-dart",children:"SignInWidget(\n  client: client,\n  emailSignInWidget: EmailSignInWidget(\n    client: client,\n    // Change the initial screen to start registration\n    startScreen: EmailFlowScreen.startRegistration,\n  ),\n)\n"})})]}),"\n",(0,o.jsxs)(n.h2,{id:"using-the-emailsigninwidget",children:["Using the ",(0,o.jsx)(n.code,{children:"EmailSignInWidget"})]}),"\n",(0,o.jsxs)(n.p,{children:["The ",(0,o.jsx)(n.code,{children:"EmailSignInWidget"})," handles the complete email authentication flow including login, registration, email verification, and password reset."]}),"\n",(0,o.jsx)(n.p,{children:"You can customize the widget's behavior using its constructor parameters:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-dart",children:"EmailSignInWidget(\n  client: client,\n  startScreen: EmailFlowScreen.login, // or startRegistration\n  // Customize the verification code configuration\n  // The default matches the default server verification code generation\n  verificationCodeConfig: VerificationCodeConfig(\n    length: 6,\n    keyboardType: TextInputType.number,\n    allowedLetterCase: LetterCase.lowercase,\n    allowedCharactersPattern: RegExp(r'[0-9]'),\n    resendCountdownDuration: Duration(minutes: 1),\n  ),\n  // Custom email validation function\n  emailValidation: (email) {\n    if (!email.contains('@example.com')) {\n      throw FormatException('Only @example.com emails allowed');\n    }\n  },\n  // Customize the password requirements\n  // If omitted, uses the default configuration below\n  passwordRequirements: [\n    PasswordRequirement.minLength(12),\n    PasswordRequirement.containsUppercase(),\n    PasswordRequirement.containsLowercase(),\n    PasswordRequirement.containsNumber(),\n    PasswordRequirement.containsSpecialCharacter(),\n  ],\n  onTermsAndConditionsPressed: () {\n    // Open terms and conditions\n  },\n  onPrivacyPolicyPressed: () {\n    // Open privacy policy\n  },\n  onAuthenticated: () {\n    // Handle successful authentication\n  },\n  onError: (error) {\n    // Handle errors\n  },\n  // Change the wait time before a user can request a new verification code\n  resendCountdownDuration: Duration(minutes: 2),\n)\n"})}),"\n",(0,o.jsxs)(n.p,{children:["Optionally, you can provide an externally managed ",(0,o.jsx)(n.code,{children:"EmailAuthController"})," instance to the widget, which will ignore all other configuration options in favor of the controller's state. The controller contains all options above - with the exception of the ",(0,o.jsx)(n.code,{children:"verificationCodeConfig"})," option, which is only used by the widget."]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-dart",children:"EmailSignInWidget(\n  client: client,\n  controller: controller,\n)\n"})}),"\n",(0,o.jsx)(n.admonition,{type:"info",children:(0,o.jsxs)(n.p,{children:["The terms and conditions and privacy policy checkbox on the registration screen are optional and disabled by default. The checkbox will only be shown if you provide both ",(0,o.jsx)(n.code,{children:"onTermsAndConditionsPressed"})," and ",(0,o.jsx)(n.code,{children:"onPrivacyPolicyPressed"})," callbacks."]})}),"\n",(0,o.jsx)(n.h3,{id:"customizing-the-default-widgets-appearance",children:"Customizing the default widget's appearance"}),"\n",(0,o.jsxs)(n.p,{children:["Since the ",(0,o.jsx)(n.code,{children:"EmailSignInWidget"})," uses the material design system, it will react to your app's material theme. You can also wrap it in a ",(0,o.jsx)(n.code,{children:"Theme"})," widget to apply a custom theme."]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-dart",children:"import 'package:serverpod_auth_idp_flutter/serverpod_auth_idp_flutter.dart';\n\nTheme(\n  data: Theme.of(context).copyWith(\n    colorScheme: ColorScheme.fromSeed(seedColor: Colors.blue),\n    // Use the AuthIdpTheme to customize the verification code input look\n    extensions: <ThemeExtension<dynamic>>[\n      AuthIdpTheme(\n        defaultPinTheme: PinTheme(...),\n        errorPinTheme: PinTheme(...),\n        successPinTheme: PinTheme(...),\n      ),\n    ],\n  ),\n  child: EmailSignInWidget(client: client),\n)\n"})}),"\n",(0,o.jsxs)(n.h2,{id:"building-a-custom-ui-with-the-emailauthcontroller",children:["Building a custom UI with the ",(0,o.jsx)(n.code,{children:"EmailAuthController"})]}),"\n",(0,o.jsxs)(n.p,{children:["For more control over the UI, you can use the ",(0,o.jsx)(n.code,{children:"EmailAuthController"})," class, which provides all the authentication logic without any UI components. This allows you to build a completely custom authentication interface."]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-dart",children:"import 'package:serverpod_auth_idp_flutter/serverpod_auth_idp_flutter.dart';\n\nfinal controller = EmailAuthController(\n  client: client,\n  startScreen: EmailFlowScreen.login,\n  onAuthenticated: () {\n    // Handle successful authentication\n  },\n  onError: (error) {\n    // Handle errors\n  },\n);\n"})}),"\n",(0,o.jsx)(n.h3,{id:"emailauthcontroller-state-management",children:"EmailAuthController State Management"}),"\n",(0,o.jsxs)(n.p,{children:["Your widget should render the appropriate screen based on the ",(0,o.jsx)(n.code,{children:"currentScreen"})," property of the controller. You can also use the below state properties to build your UI:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-dart",children:"// Check current screen\nfinal currentScreen = controller.currentScreen;\n\n// Check if loading\nfinal isLoading = controller.isLoading;\n\n// Check if authenticated\nfinal isAuthenticated = controller.isAuthenticated;\n\n// Get error message\nfinal errorMessage = controller.errorMessage;\n\n// Listen to state changes\ncontroller.addListener(() {\n  setState(() {\n    // Rebuild UI when controller state changes\n  });\n});\n"})}),"\n",(0,o.jsx)(n.h2,{id:"the-email-authentication-flow",children:"The email authentication flow"}),"\n",(0,o.jsx)(n.p,{children:"The email authentication flow uses the following screens:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"EmailFlowScreen.login"})," - Login with email and password"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"EmailFlowScreen.startRegistration"})," - Start registration with email"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"EmailFlowScreen.verifyRegistration"})," - Verify registration code"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"EmailFlowScreen.completeRegistration"})," - Set password to complete registration"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"EmailFlowScreen.requestPasswordReset"})," - Request password reset"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"EmailFlowScreen.verifyPasswordReset"})," - Verify password reset code"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"EmailFlowScreen.completePasswordReset"})," - Set new password"]}),"\n"]}),"\n",(0,o.jsx)(n.h3,{id:"navigating-between-screens",children:"Navigating between screens"}),"\n",(0,o.jsx)(n.p,{children:"The controller handles navigation between screens automatically when calling the methods associated with each screen, but you can also navigate manually:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-dart",children:"// Navigate to a specific screen\ncontroller.navigateTo(EmailFlowScreen.startRegistration);\n\n// Navigate back\nif (controller.canNavigateBack) {\n  controller.navigateBack();\n}\n"})}),"\n",(0,o.jsx)(n.h3,{id:"emailauthcontroller-methods",children:"EmailAuthController Methods"}),"\n",(0,o.jsx)(n.p,{children:"The controller provides methods for each step of the authentication flow:"}),"\n",(0,o.jsx)(n.admonition,{type:"info",children:(0,o.jsxs)(n.p,{children:["The ",(0,o.jsx)(n.code,{children:"EmailAuthController"})," already exposes internal text controllers for the email, password and verification code inputs. You can use these to build your own custom UI. All controllers are shared between login, registration and password reset flows for good UX. The ",(0,o.jsx)(n.code,{children:"EmailAuthController"})," will handle the cleanup of the text controllers upon navigation as needed."]})}),"\n",(0,o.jsx)(n.h4,{id:"login",children:"Login"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-dart",children:"// Set email and password in the controller's text controllers\ncontroller.emailController.text = 'user@example.com';\ncontroller.passwordController.text = 'password123';\n\n// Call login\nawait controller.login();\n"})}),"\n",(0,o.jsx)(n.h4,{id:"registration-flow",children:"Registration Flow"}),"\n",(0,o.jsx)(n.p,{children:"The registration flow consists of three steps:"}),"\n",(0,o.jsxs)(n.ol,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Start Registration"})," - Request a verification code:"]}),"\n"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-dart",children:"controller.emailController.text = 'user@example.com';\nawait controller.startRegistration();\n// Controller navigates to verification screen\n"})}),"\n",(0,o.jsxs)(n.ol,{start:"2",children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Verify Registration Code"})," - Enter the verification code:"]}),"\n"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-dart",children:"controller.verificationCodeController.text = '12345678';\nawait controller.verifyRegistrationCode();\n// Controller navigates to password setup screen\n"})}),"\n",(0,o.jsxs)(n.ol,{start:"3",children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Complete Registration"})," - Set password:"]}),"\n"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-dart",children:"controller.passwordController.text = 'securePassword123';\nawait controller.finishRegistration();\n// User is now authenticated\n"})}),"\n",(0,o.jsx)(n.h4,{id:"password-reset-flow",children:"Password Reset Flow"}),"\n",(0,o.jsx)(n.p,{children:"The password reset flow also consists of three steps:"}),"\n",(0,o.jsxs)(n.ol,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Request Password Reset"}),":"]}),"\n"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-dart",children:"controller.emailController.text = 'user@example.com';\nawait controller.startPasswordReset();\n// Controller navigates to verification screen\n"})}),"\n",(0,o.jsxs)(n.ol,{start:"2",children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Verify Reset Code"}),":"]}),"\n"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-dart",children:"controller.verificationCodeController.text = '12345678';\nawait controller.verifyPasswordResetCode();\n// Controller navigates to new password screen\n"})}),"\n",(0,o.jsxs)(n.ol,{start:"3",children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Complete Password Reset"}),":"]}),"\n"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-dart",children:"controller.passwordController.text = 'newSecurePassword123';\nawait controller.finishPasswordReset();\n// User is authenticated with new password\n"})}),"\n",(0,o.jsx)(n.h3,{id:"resending-verification-codes",children:"Resending Verification Codes"}),"\n",(0,o.jsx)(n.p,{children:"To resend a verification code:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-dart",children:"await controller.resendVerificationCode();\n"})}),"\n",(0,o.jsx)(n.p,{children:"This will resend the code based on the current screen (registration or password reset)."})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(d,{...e})}):d(e)}},28453:(e,n,t)=>{t.d(n,{R:()=>s,x:()=>a});var i=t(96540);const o={},r=i.createContext(o);function s(e){const n=i.useContext(r);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:s(e.components),i.createElement(r.Provider,{value:n},e.children)}}}]);