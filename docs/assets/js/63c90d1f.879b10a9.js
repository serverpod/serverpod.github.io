"use strict";(globalThis.webpackChunkserverpod_docs=globalThis.webpackChunkserverpod_docs||[]).push([[66211],{26112(e,n,i){i.r(n),i.d(n,{assets:()=>d,contentTitle:()=>c,default:()=>h,frontMatter:()=>s,metadata:()=>t,toc:()=>a});const t=JSON.parse('{"id":"concepts/authentication/providers/microsoft/setup","title":"Setup","description":"To set up Sign in with Microsoft, you must create an app registration on Microsoft Entra ID (formerly Azure AD) and configure your Serverpod application accordingly.","source":"@site/docs/06-concepts/11-authentication/04-providers/07-microsoft/01-setup.md","sourceDirName":"06-concepts/11-authentication/04-providers/07-microsoft","slug":"/concepts/authentication/providers/microsoft/setup","permalink":"/next/concepts/authentication/providers/microsoft/setup","draft":false,"unlisted":false,"editUrl":"https://github.com/serverpod/serverpod_docs/tree/main/docs/06-concepts/11-authentication/04-providers/07-microsoft/01-setup.md","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Customizing the UI","permalink":"/next/concepts/authentication/providers/github/customizing-the-ui"},"next":{"title":"Configuration","permalink":"/next/concepts/authentication/providers/microsoft/configuration"}}');var r=i(74848),o=i(28453);const s={},c="Setup",d={},a=[{value:"Create your Microsoft Entra ID App",id:"create-your-microsoft-entra-id-app",level:2},{value:"Get app credentials",id:"get-app-credentials",level:2},{value:"Get the client ID",id:"get-the-client-id",level:3},{value:"Create a client secret",id:"create-a-client-secret",level:3},{value:"Get the tenant ID (Optional)",id:"get-the-tenant-id-optional",level:3},{value:"Configure redirect URIs",id:"configure-redirect-uris",level:3},{value:"Web",id:"web",level:4},{value:"iOS and macOS",id:"ios-and-macos",level:4},{value:"Android",id:"android",level:4},{value:"Server-side configuration",id:"server-side-configuration",level:2},{value:"Store the credentials",id:"store-the-credentials",level:3},{value:"Configure the Microsoft Identity Provider",id:"configure-the-microsoft-identity-provider",level:3},{value:"Expose the endpoint",id:"expose-the-endpoint",level:3},{value:"Generate and migrate",id:"generate-and-migrate",level:3},{value:"Basic configuration options",id:"basic-configuration-options",level:3},{value:"Client-side configuration",id:"client-side-configuration",level:2},{value:"iOS and macOS",id:"ios-and-macos-1",level:3},{value:"Android",id:"android-1",level:3},{value:"Web",id:"web-1",level:3},{value:"Present the authentication UI",id:"present-the-authentication-ui",level:2},{value:"Initializing the <code>MicrosoftSignInService</code>",id:"initializing-the-microsoftsigninservice",level:3},{value:"Using the <code>MicrosoftSignInWidget</code>",id:"using-the-microsoftsigninwidget",level:3}];function l(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"setup",children:"Setup"})}),"\n",(0,r.jsxs)(n.p,{children:["To set up ",(0,r.jsx)(n.strong,{children:"Sign in with Microsoft"}),", you must create an app registration on ",(0,r.jsx)(n.a,{href:"https://portal.azure.com/",children:"Microsoft Entra ID (formerly Azure AD)"})," and configure your Serverpod application accordingly."]}),"\n",(0,r.jsx)(n.admonition,{type:"caution",children:(0,r.jsxs)(n.p,{children:["You need to install the auth module before you continue, see ",(0,r.jsx)(n.a,{href:"../../setup",children:"Setup"}),"."]})}),"\n",(0,r.jsx)(n.h2,{id:"create-your-microsoft-entra-id-app",children:"Create your Microsoft Entra ID App"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Go to ",(0,r.jsx)(n.a,{href:"https://portal.azure.com/",children:"Microsoft Azure Portal"})," and log in with your Microsoft account."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Navigate to ",(0,r.jsx)(n.strong,{children:"Microsoft Entra ID"})," from the portal menu."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"Register App",src:i(30142).A+"",width:"2353",height:"1546"})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Go to ",(0,r.jsx)(n.strong,{children:"App registrations"})," and click ",(0,r.jsx)(n.strong,{children:"New registration"}),"."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"New App Registration",src:i(20082).A+"",width:"1768",height:"770"})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Fill in the required fields:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Name"}),': Enter a name for your application (e.g., "MyApp Authentication").']}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Supported account types"}),": Choose one of the following:","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Single tenant only - Default Directory"}),"\n",(0,r.jsx)(n.li,{children:"Multiple Entra ID tenants"}),"\n",(0,r.jsx)(n.li,{children:"Any Entra ID Tenant + Personal Microsoft accounts"}),"\n",(0,r.jsx)(n.li,{children:"Personal accounts only"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Redirect URI (optional)"}),": Leave this blank for now. We'll add platform-specific URIs later."]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"Microsoft App Setup",src:i(12145).A+"",width:"1770",height:"1483"})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Click ",(0,r.jsx)(n.strong,{children:"Register"})," to create your app."]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"get-app-credentials",children:"Get app credentials"}),"\n",(0,r.jsx)(n.h3,{id:"get-the-client-id",children:"Get the client ID"}),"\n",(0,r.jsxs)(n.p,{children:["After registration, you'll be redirected to the app overview page where you can find your ",(0,r.jsx)(n.strong,{children:"Application (client) ID"}),". Copy this value - you'll need it for server configuration."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"Client ID",src:i(60523).A+"",width:"2349",height:"1587"})}),"\n",(0,r.jsx)(n.h3,{id:"create-a-client-secret",children:"Create a client secret"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["In your app's menu, navigate to ",(0,r.jsx)(n.strong,{children:"Certificates & secrets"}),"."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Under ",(0,r.jsx)(n.strong,{children:"Client secrets"}),", click ",(0,r.jsx)(n.strong,{children:"New client secret"}),"."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"Create Client Secret",src:i(67222).A+"",width:"2353",height:"1240"})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:'Add a description (e.g., "Serverpod Authentication") and choose an expiration period.'}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Click ",(0,r.jsx)(n.strong,{children:"Add"})," and immediately copy the ",(0,r.jsx)(n.strong,{children:"Value"})," (not the Secret ID). This is your ",(0,r.jsx)(n.strong,{children:"Client Secret"}),"."]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.admonition,{type:"warning",children:(0,r.jsx)(n.p,{children:"The client secret value is only shown once. Store it securely immediately after creation. Never commit this value to version control."})}),"\n",(0,r.jsx)(n.h3,{id:"get-the-tenant-id-optional",children:"Get the tenant ID (Optional)"}),"\n",(0,r.jsxs)(n.p,{children:["If you're restricting authentication to a specific tenant, you'll need your ",(0,r.jsx)(n.strong,{children:"Directory (tenant) ID"}),", which is also shown on the app overview page. For most applications, you can use one of these common values:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"common"}),": Allows both personal Microsoft accounts and work/school accounts (default)."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"organizations"}),": Allows only work/school accounts."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"consumers"}),": Allows only personal Microsoft accounts."]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"configure-redirect-uris",children:"Configure redirect URIs"}),"\n",(0,r.jsx)(n.p,{children:"You need to configure redirect URIs for each platform you want to support."}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["In your app's menu, navigate to ",(0,r.jsx)(n.strong,{children:"Authentication"}),"."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Click ",(0,r.jsx)(n.strong,{children:"Add a platform"})," to configure platform-specific settings."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"Authentication Redirect",src:i(47128).A+"",width:"2353",height:"1683"})}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h4,{id:"web",children:"Web"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Select ",(0,r.jsx)(n.strong,{children:"Web"})," as the platform."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Add your redirect URI, typically in the format: ",(0,r.jsx)(n.code,{children:"https://yourdomain.com/auth.html"})]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"Web Redirect URI",src:i(89591).A+"",width:"1165",height:"696"})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Click ",(0,r.jsx)(n.strong,{children:"Configure"}),"."]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h4,{id:"ios-and-macos",children:"iOS and macOS"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Select ",(0,r.jsx)(n.strong,{children:"iOS / macOS"})," as the platform."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["For the Bundle ID, enter your app's bundle identifier (e.g., ",(0,r.jsx)(n.code,{children:"com.yourcompany.yourapp"}),")."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"iOS/macOS Redirect URI",src:i(12117).A+"",width:"1703",height:"386"})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Click ",(0,r.jsx)(n.strong,{children:"Configure"}),"."]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.admonition,{type:"note",children:(0,r.jsx)(n.p,{children:"For iOS/macOS, Microsoft will automatically generate the redirect URI based on your bundle ID. You can also add custom redirect URIs as needed."})}),"\n",(0,r.jsx)(n.h4,{id:"android",children:"Android"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Select ",(0,r.jsx)(n.strong,{children:"Android"})," as the platform."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Enter your Package name (e.g., ",(0,r.jsx)(n.code,{children:"com.yourcompany.yourapp"}),")."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Enter your Signature hash. You can get this by running:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:" keytool -exportcert -alias SIGNATURE_ALIAS -keystore PATH_TO_KEYSTORE | openssl sha1 -binary | openssl base64\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"Android Redirect URI",src:i(81524).A+"",width:"1707",height:"968"})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Click ",(0,r.jsx)(n.strong,{children:"Configure"}),"."]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.admonition,{type:"tip",children:(0,r.jsx)(n.p,{children:"For development, use your debug keystore signature hash. For production builds, use your release keystore signature hash. You can add both to Microsoft Entra ID during setup."})}),"\n",(0,r.jsx)(n.h2,{id:"server-side-configuration",children:"Server-side configuration"}),"\n",(0,r.jsx)(n.h3,{id:"store-the-credentials",children:"Store the credentials"}),"\n",(0,r.jsxs)(n.p,{children:["Add your Microsoft credentials to the ",(0,r.jsx)(n.code,{children:"config/passwords.yaml"})," file, or set them as environment variables ",(0,r.jsx)(n.code,{children:"SERVERPOD_PASSWORD_microsoftClientId"}),", ",(0,r.jsx)(n.code,{children:"SERVERPOD_PASSWORD_microsoftClientSecret"}),", and ",(0,r.jsx)(n.code,{children:"SERVERPOD_PASSWORD_microsoftTenant"}),"."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"development:\n  microsoftClientId: 'YOUR_MICROSOFT_CLIENT_ID'\n  microsoftClientSecret: 'YOUR_MICROSOFT_CLIENT_SECRET'\n  microsoftTenant: 'common' # or 'organizations', 'consumers', or your specific tenant ID\n"})}),"\n",(0,r.jsx)(n.admonition,{type:"warning",children:(0,r.jsx)(n.p,{children:"Keep your Client Secret confidential. Never commit this value to version control. Store it securely using environment variables or secret management."})}),"\n",(0,r.jsx)(n.h3,{id:"configure-the-microsoft-identity-provider",children:"Configure the Microsoft Identity Provider"}),"\n",(0,r.jsxs)(n.p,{children:["In your main ",(0,r.jsx)(n.code,{children:"server.dart"})," file, configure the Microsoft identity provider:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-dart",children:"import 'package:serverpod/serverpod.dart';\nimport 'package:serverpod_auth_idp_server/core.dart';\nimport 'package:serverpod_auth_idp_server/providers/microsoft.dart';\n\nvoid run(List<String> args) async {\n  final pod = Serverpod(\n    args,\n    Protocol(),\n    Endpoints(),\n  );\n\n  pod.initializeAuthServices(\n    tokenManagerBuilders: [\n      JwtConfigFromPasswords(),\n    ],\n    identityProviderBuilders: [\n      MicrosoftIdpConfig(\n        clientId: pod.getPassword('microsoftClientId')!,\n        clientSecret: pod.getPassword('microsoftClientSecret')!,\n        tenant: pod.getPassword('microsoftTenant') ?? 'common',\n      ),\n    ],\n  );\n\n  await pod.start();\n}\n"})}),"\n",(0,r.jsxs)(n.admonition,{type:"tip",children:[(0,r.jsxs)(n.p,{children:["You can use ",(0,r.jsx)(n.code,{children:"MicrosoftIdpConfigFromPasswords()"})," to automatically load credentials from ",(0,r.jsx)(n.code,{children:"config/passwords.yaml"})," or the ",(0,r.jsx)(n.code,{children:"SERVERPOD_PASSWORD_microsoftClientId"}),", ",(0,r.jsx)(n.code,{children:"SERVERPOD_PASSWORD_microsoftClientSecret"}),", and ",(0,r.jsx)(n.code,{children:"SERVERPOD_PASSWORD_microsoftTenant"})," environment variables:"]}),(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-dart",children:"identityProviderBuilders: [\n  MicrosoftIdpConfigFromPasswords(),\n],\n"})})]}),"\n",(0,r.jsx)(n.h3,{id:"expose-the-endpoint",children:"Expose the endpoint"}),"\n",(0,r.jsxs)(n.p,{children:["Create an endpoint that extends ",(0,r.jsx)(n.code,{children:"MicrosoftIdpBaseEndpoint"})," to expose the Microsoft authentication API:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-dart",children:"import 'package:serverpod_auth_idp_server/providers/microsoft.dart';\n\nclass MicrosoftIdpEndpoint extends MicrosoftIdpBaseEndpoint {}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"generate-and-migrate",children:"Generate and migrate"}),"\n",(0,r.jsxs)(n.p,{children:["Finally, run ",(0,r.jsx)(n.code,{children:"serverpod generate"})," to generate the client code and create a migration to initialize the database for the provider. More detailed instructions can be found in the general ",(0,r.jsx)(n.a,{href:"../../setup#identity-providers-configuration",children:"identity providers setup section"}),"."]}),"\n",(0,r.jsx)(n.h3,{id:"basic-configuration-options",children:"Basic configuration options"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"clientId"}),": Required. The Application (client) ID of your Microsoft Entra ID app."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"clientSecret"}),": Required. The Client Secret generated for your Microsoft Entra ID app."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"tenant"}),": Optional. Defaults to ",(0,r.jsx)(n.code,{children:"'common'"}),". Can be ",(0,r.jsx)(n.code,{children:"'common'"}),", ",(0,r.jsx)(n.code,{children:"'organizations'"}),", ",(0,r.jsx)(n.code,{children:"'consumers'"}),", or a specific tenant ID."]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["For more details on configuration options, see the ",(0,r.jsx)(n.a,{href:"./configuration",children:"configuration section"}),"."]}),"\n",(0,r.jsx)(n.h2,{id:"client-side-configuration",children:"Client-side configuration"}),"\n",(0,r.jsxs)(n.p,{children:["Add the ",(0,r.jsx)(n.code,{children:"serverpod_auth_idp_flutter"})," package to your Flutter app. The Microsoft provider uses ",(0,r.jsx)(n.a,{href:"https://pub.dev/packages/flutter_web_auth_2",children:(0,r.jsx)(n.code,{children:"flutter_web_auth_2"})})," to handle the OAuth2 flow, so any documentation there should also apply to this setup."]}),"\n",(0,r.jsx)(n.h3,{id:"ios-and-macos-1",children:"iOS and macOS"}),"\n",(0,r.jsxs)(n.p,{children:['There is no special configuration needed for iOS and macOS for "normal" authentication flows.\nHowever, if you are using ',(0,r.jsx)(n.strong,{children:"Universal Links"})," on iOS, they require redirect URIs to use ",(0,r.jsx)(n.strong,{children:"https"}),".\nFollow the instructions in the ",(0,r.jsx)(n.a,{href:"https://pub.dev/packages/flutter_web_auth_2#ios",children:"flutter_web_auth_2"})," documentation."]}),"\n",(0,r.jsx)(n.h3,{id:"android-1",children:"Android"}),"\n",(0,r.jsxs)(n.p,{children:["In order to capture the callback URL, add the following activity to your ",(0,r.jsx)(n.code,{children:"AndroidManifest.xml"}),". Replace ",(0,r.jsx)(n.code,{children:"YOUR_CALLBACK_URL_SCHEME_HERE"})," and ",(0,r.jsx)(n.code,{children:"YOUR_CALLBACK_URL_HOST_HERE"})," with your actual callback URL scheme and host registered in your Microsoft Entra ID app."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-xml",children:'<manifest>\n    <application>\n\n        <activity\n            android:name="com.linusu.flutter_web_auth_2.CallbackActivity"\n            android:exported="true"\n            android:taskAffinity="">\n            <intent-filter android:label="Microsoft Authentication">\n                <action android:name="android.intent.action.VIEW" />\n                <category android:name="android.intent.category.DEFAULT" />\n                <category android:name="android.intent.category.BROWSABLE" />\n                <data\n                        android:scheme="YOUR_CALLBACK_URL_SCHEME_HERE"\n                        android:host="YOUR_CALLBACK_URL_HOST_HERE" />\n            </intent-filter>\n        </activity>\n\n    </application>\n</manifest>\n'})}),"\n",(0,r.jsx)(n.h3,{id:"web-1",children:"Web"}),"\n",(0,r.jsxs)(n.p,{children:["On the web, you need a specific endpoint to capture the OAuth2 callback. To set this up, create an HTML file (e.g., ",(0,r.jsx)(n.code,{children:"auth.html"}),") inside your project's ",(0,r.jsx)(n.code,{children:"./web"})," folder and add the following content:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-html",children:"<!DOCTYPE html>\n<title>Authentication complete</title>\n<p>Authentication is complete. If this does not happen automatically, please close the window.</p>\n<script>\n  function postAuthenticationMessage() {\n    const message = {\n      'flutter-web-auth-2': window.location.href\n    };\n\n    if (window.opener) {\n      window.opener.postMessage(message, window.location.origin);\n      window.close();\n    } else if (window.parent && window.parent !== window) {\n      window.parent.postMessage(message, window.location.origin);\n    } else {\n      localStorage.setItem('flutter-web-auth-2', window.location.href);\n      window.close();\n    }\n  }\n\n  postAuthenticationMessage();\n<\/script>\n"})}),"\n",(0,r.jsx)(n.admonition,{type:"note",children:(0,r.jsxs)(n.p,{children:["You only need a single callback file (e.g. ",(0,r.jsx)(n.code,{children:"auth.html"}),") in your ",(0,r.jsx)(n.code,{children:"./web"})," folder.\nThis file is shared across all IDPs that use the OAuth2 utility, as long as your redirect URIs point to it."]})}),"\n",(0,r.jsx)(n.h2,{id:"present-the-authentication-ui",children:"Present the authentication UI"}),"\n",(0,r.jsxs)(n.h3,{id:"initializing-the-microsoftsigninservice",children:["Initializing the ",(0,r.jsx)(n.code,{children:"MicrosoftSignInService"})]}),"\n",(0,r.jsx)(n.p,{children:"Before presenting any sign-in UI, initialize the Microsoft Sign-In service. This step is necessary to configure the service with your Microsoft app credentials."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-dart",children:"await client.auth.initializeMicrosoftSignIn(\n  clientId: 'YOUR_MICROSOFT_CLIENT_ID',\n  redirectUri: 'YOUR_REGISTERED_REDIRECT_URI',\n);\n"})}),"\n",(0,r.jsx)(n.admonition,{type:"info",children:(0,r.jsxs)(n.p,{children:["For more information on configuration options and environment variables, see the ",(0,r.jsx)(n.a,{href:"./configuration",children:"configuration section"}),"."]})}),"\n",(0,r.jsxs)(n.h3,{id:"using-the-microsoftsigninwidget",children:["Using the ",(0,r.jsx)(n.code,{children:"MicrosoftSignInWidget"})]}),"\n",(0,r.jsxs)(n.p,{children:["If you have configured the ",(0,r.jsx)(n.code,{children:"SignInWidget"})," as described in the ",(0,r.jsx)(n.a,{href:"../../setup#present-the-authentication-ui",children:"setup section"}),", the Microsoft identity provider will be automatically detected and displayed in the sign-in widget."]}),"\n",(0,r.jsxs)(n.p,{children:["You can also use the ",(0,r.jsx)(n.code,{children:"MicrosoftSignInWidget"})," to include the Microsoft authentication flow in your own custom UI."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-dart",children:"import 'package:serverpod_auth_idp_flutter/serverpod_auth_idp_flutter.dart';\n\nMicrosoftSignInWidget(\n  client: client,\n  onAuthenticated: () {\n    // Do something when the user is authenticated.\n    //\n    // NOTE: You should not navigate to the home screen here, otherwise\n    // the user will have to sign in again every time they open the app.\n  },\n  onError: (error) {\n    // Handle errors\n    ScaffoldMessenger.of(context).showSnackBar(\n      SnackBar(content: Text('Error: $error')),\n    );\n  },\n)\n"})}),"\n",(0,r.jsx)(n.p,{children:"The widget automatically handles:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Microsoft Sign-In flow for iOS, Android, Web, and macOS."}),"\n",(0,r.jsx)(n.li,{children:"OAuth2 authentication flow."}),"\n",(0,r.jsx)(n.li,{children:"Token management."}),"\n",(0,r.jsx)(n.li,{children:"Underlying OAuth2 package error handling."}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["For details on how to customize the Microsoft Sign-In UI in your Flutter app, see the ",(0,r.jsx)(n.a,{href:"./customizing-the-ui",children:"customizing the UI section"}),"."]})]})}function h(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(l,{...e})}):l(e)}},30142(e,n,i){i.d(n,{A:()=>t});const t=i.p+"assets/images/1-register-app-f5ca8aa773ec5e924463383aa3f4b421.png"},20082(e,n,i){i.d(n,{A:()=>t});const t=i.p+"assets/images/2-register-new-app-ef3c59af5c7837d0295238bf4f1d9b4c.png"},12145(e,n,i){i.d(n,{A:()=>t});const t=i.p+"assets/images/3-ms-f618ec56e77aea222e7d89004fb0f7ff.png"},60523(e,n,i){i.d(n,{A:()=>t});const t=i.p+"assets/images/4-client-id-9694500ad249b945e3c5989f38277885.png"},67222(e,n,i){i.d(n,{A:()=>t});const t=i.p+"assets/images/5-create-client-secret-5238a8d3b51d1a1690e7dab0d6b37733.png"},47128(e,n,i){i.d(n,{A:()=>t});const t=i.p+"assets/images/6-authentication-redirect-uri-669b139b88c3958b6d32780750df08da.png"},89591(e,n,i){i.d(n,{A:()=>t});const t=i.p+"assets/images/7-web-redirect-uri-62cbf07085b4464642bff7120161b73a.png"},12117(e,n,i){i.d(n,{A:()=>t});const t=i.p+"assets/images/8-ios-macos-redirect-uri-6d42074b78c7768753c8f1b2f9522ced.png"},81524(e,n,i){i.d(n,{A:()=>t});const t=i.p+"assets/images/9-android-redirect-uri-299c45a8b5ac0fe94193d2bbfb298f66.png"},28453(e,n,i){i.d(n,{R:()=>s,x:()=>c});var t=i(96540);const r={},o=t.createContext(r);function s(e){const n=t.useContext(o);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:s(e.components),t.createElement(o.Provider,{value:n},e.children)}}}]);