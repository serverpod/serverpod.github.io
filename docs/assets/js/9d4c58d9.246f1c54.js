"use strict";(globalThis.webpackChunkserverpod_docs=globalThis.webpackChunkserverpod_docs||[]).push([[29005],{58586(e,n,s){s.r(n),s.d(n,{assets:()=>d,contentTitle:()=>a,default:()=>h,frontMatter:()=>r,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"concepts/authentication/token-managers/server-side-sessions-token-manager","title":"Server-side Sessions Token Manager","description":"The ServerSideSessionsTokenManager uses session-based tokens stored in the database. This token manager provides:","source":"@site/versioned_docs/version-3.1.0/06-concepts/11-authentication/05-token-managers/03-server-side-sessions-token-manager.md","sourceDirName":"06-concepts/11-authentication/05-token-managers","slug":"/concepts/authentication/token-managers/server-side-sessions-token-manager","permalink":"/3.1.0/concepts/authentication/token-managers/server-side-sessions-token-manager","draft":false,"unlisted":false,"editUrl":"https://github.com/serverpod/serverpod_docs/tree/main/versioned_docs/version-3.1.0/06-concepts/11-authentication/05-token-managers/03-server-side-sessions-token-manager.md","tags":[],"version":"3.1.0","sidebarPosition":3,"frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"JWT Token Manager","permalink":"/3.1.0/concepts/authentication/token-managers/jwt-token-manager"},"next":{"title":"UI Components","permalink":"/3.1.0/concepts/authentication/ui-components"}}');var o=s(74848),t=s(28453);const r={},a="Server-side Sessions Token Manager",d={},c=[{value:"Server-side configuration",id:"server-side-configuration",level:2},{value:"Basic configuration options",id:"basic-configuration-options",level:3},{value:"Extra configuration options",id:"extra-configuration-options",level:3},{value:"Client-side configuration",id:"client-side-configuration",level:2}];function l(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,t.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.header,{children:(0,o.jsx)(n.h1,{id:"server-side-sessions-token-manager",children:"Server-side Sessions Token Manager"})}),"\n",(0,o.jsxs)(n.p,{children:["The ",(0,o.jsx)(n.code,{children:"ServerSideSessionsTokenManager"})," uses session-based tokens stored in the database. This token manager provides:"]}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"Stateful authentication (database queries for validation)."}),"\n",(0,o.jsx)(n.li,{children:"Immediate session revocation."}),"\n",(0,o.jsx)(n.li,{children:"Immediate scopes update on existing sessions."}),"\n",(0,o.jsx)(n.li,{children:"Support for session expiration and inactivity timeouts."}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"server-side-configuration",children:"Server-side configuration"}),"\n",(0,o.jsxs)(n.p,{children:["This token manager is created by passing a ",(0,o.jsx)(n.code,{children:"ServerSideSessionsConfig"})," object to the ",(0,o.jsx)(n.code,{children:"pod.initializeAuthServices()"})," as a ",(0,o.jsx)(n.code,{children:"tokenManagerBuilder"}),"."]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-dart",children:"pod.initializeAuthServices(\n  tokenManagerBuilders: [\n    ServerSideSessionsConfig(\n      // The pepper used to hash the session key.\n      sessionKeyHashPepper: pod.getPassword('serverSideSessionKeyHashPepper')!,\n    ),\n  ],\n);\n"})}),"\n",(0,o.jsx)(n.admonition,{type:"tip",children:(0,o.jsxs)(n.p,{children:["You can use the ",(0,o.jsx)(n.code,{children:"ServerSideSessionsConfigFromPasswords"})," constructor in replacement of the ",(0,o.jsx)(n.code,{children:"ServerSideSessionsConfig"})," above to automatically load the credentials from the ",(0,o.jsx)(n.code,{children:"config/passwords.yaml"})," file or environment variables. It will expect the ",(0,o.jsx)(n.code,{children:"serverSideSessionKeyHashPepper"})," key on the file or the ",(0,o.jsx)(n.code,{children:"SERVERPOD_PASSWORD_serverSideSessionKeyHashPepper"})," environment variable."]})}),"\n",(0,o.jsx)(n.h3,{id:"basic-configuration-options",children:"Basic configuration options"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"sessionKeyHashPepper"}),": Required. A secret pepper used for hashing session keys. Must be at least 10 characters long, but ",(0,o.jsx)(n.a,{href:"https://www.ietf.org/archive/id/draft-ietf-kitten-password-storage-04.html#name-storage-2",children:"the recommended length is 32 bytes"}),"."]}),"\n"]}),"\n",(0,o.jsx)(n.h3,{id:"extra-configuration-options",children:"Extra configuration options"}),"\n",(0,o.jsxs)(n.p,{children:["Below is an example of a non-exhaustive list of some of the most common configuration options for the ",(0,o.jsx)(n.code,{children:"ServerSideSessionsTokenManager"}),". For more details on all options, check the ",(0,o.jsx)(n.code,{children:"ServerSideSessionsConfig"})," in-code documentation."]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-dart",children:"final serverSideSessionsConfig = ServerSideSessionsConfigFromPasswords(\n  // Optional: Fallback peppers for pepper rotation\n  // This is useful for allowing old sessions to be validated after a rotation.\n  fallbackSessionKeyHashPeppers: [\n    pod.getPassword('oldSessionKeyHashPepper')!,\n  ],\n  // Optional: Set default session lifetime (default is to never expire)\n  defaultSessionLifetime: Duration(days: 30),\n  // Optional: Set inactivity timeout (default is to never timeout)\n  defaultSessionInactivityTimeout: Duration(days: 7),\n  // Optional: Configure session key properties\n  sessionKeySecretLength: 32,\n  sessionKeyHashSaltLength: 16,\n  // Check the [ServerSideSessionsConfig] documentation for more options.\n);\n"})}),"\n",(0,o.jsx)(n.h2,{id:"client-side-configuration",children:"Client-side configuration"}),"\n",(0,o.jsxs)(n.p,{children:["When using the ",(0,o.jsx)(n.code,{children:"ServerSideSessionsTokenManager"})," in the server, no extra configuration is needed on the client. It will automatically include the session token in requests to the server. In case the session expires or is revoked, the client will automatically sign the user out and redirect to the login page."]})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(l,{...e})}):l(e)}},28453(e,n,s){s.d(n,{R:()=>r,x:()=>a});var i=s(96540);const o={},t=i.createContext(o);function r(e){const n=i.useContext(t);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:r(e.components),i.createElement(t.Provider,{value:n},e.children)}}}]);