"use strict";(self.webpackChunkserverpod_docs=self.webpackChunkserverpod_docs||[]).push([[926],{66756:(e,t,s)=>{s.r(t),s.d(t,{assets:()=>d,contentTitle:()=>o,default:()=>l,frontMatter:()=>a,metadata:()=>n,toc:()=>c});const n=JSON.parse('{"id":"concepts/authentication/working-with-users","title":"Working with users","description":"The authentication module provides conventient ways to work with your authenticated users and their related profile data.","source":"@site/versioned_docs/version-3.0.0/06-concepts/11-authentication/03-working-with-users.md","sourceDirName":"06-concepts/11-authentication","slug":"/concepts/authentication/working-with-users","permalink":"/concepts/authentication/working-with-users","draft":false,"unlisted":false,"editUrl":"https://github.com/serverpod/serverpod_docs/tree/main/versioned_docs/version-3.0.0/06-concepts/11-authentication/03-working-with-users.md","tags":[],"version":"3.0.0","sidebarPosition":3,"frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"The basics","permalink":"/concepts/authentication/basics"},"next":{"title":"Setup","permalink":"/concepts/authentication/providers/email/setup"}}');var i=s(74848),r=s(28453);const a={},o="Working with users",d={},c=[{value:"Authenticated users",id:"authenticated-users",level:2},{value:"User profiles",id:"user-profiles",level:2},{value:"Attaching additional information",id:"attaching-additional-information",level:2}];function h(e){const t={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",p:"p",pre:"pre",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(t.header,{children:(0,i.jsx)(t.h1,{id:"working-with-users",children:"Working with users"})}),"\n",(0,i.jsx)(t.p,{children:"The authentication module provides conventient ways to work with your authenticated users and their related profile data."}),"\n",(0,i.jsx)(t.h2,{id:"authenticated-users",children:"Authenticated users"}),"\n",(0,i.jsxs)(t.p,{children:["All authenticated users have an authentication identifier, that uniquely identifies them across the server. This can be retrieved from the ",(0,i.jsx)(t.code,{children:"session"})," object as a ",(0,i.jsx)(t.code,{children:"String"})," through the ",(0,i.jsx)(t.code,{children:"userIdentifier"})," property or as a ",(0,i.jsx)(t.code,{children:"UuidValue"})," from the ",(0,i.jsx)(t.code,{children:"authUserId"})," extension provided by the authentication module."]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-dart",children:"var userIdString = session.authenticated?.userIdentifier;\n// requires `import 'package:serverpod_auth_idp_server/serverpod_auth_idp_server.dart';`\nvar userIdUuidValue = session.authenticated?.authUserId;\n"})}),"\n",(0,i.jsxs)(t.p,{children:["Further operations on the authenticated user can be performed using the ",(0,i.jsx)(t.code,{children:"AuthUsers"})," class which is provide by the ",(0,i.jsx)(t.code,{children:"AuthServices"})," instance."]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-dart",children:"await AuthServices.instance.authUsers.delete(session, userIdUuidValue);\n"})}),"\n",(0,i.jsxs)(t.p,{children:["For the full list of operations, see the ",(0,i.jsx)(t.a,{href:"https://pub.dev/documentation/serverpod_auth_core_server/latest/serverpod_auth_core_server/AuthUsers-class.html",children:"AuthUsers"})," class documentation."]}),"\n",(0,i.jsx)(t.h2,{id:"user-profiles",children:"User profiles"}),"\n",(0,i.jsxs)(t.p,{children:["By default, all authenticated users have a ",(0,i.jsx)(t.code,{children:"UserProfile"})," object that contains information about the signed-in user. To access the ",(0,i.jsx)(t.code,{children:"UserProfile"})," object, you can use the ",(0,i.jsx)(t.code,{children:"userProfile"})," extension on the ",(0,i.jsx)(t.code,{children:"AuthenticationInfo"})," object."]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-dart",children:"var userProfile = await session.authenticated?.userProfile(session);\n"})}),"\n",(0,i.jsxs)(t.p,{children:["The ",(0,i.jsx)(t.code,{children:"UserProfile"})," contains a basic set of information about the user, such as their full name, email address, and profile picture."]}),"\n",(0,i.jsx)(t.p,{children:"This information is automatically populated when the user signs in. Based on the authentication method used, different data may be available."}),"\n",(0,i.jsxs)(t.p,{children:["It's a common task to read or update user information on your server. The ",(0,i.jsx)(t.code,{children:"UserProfiles"})," class provides many convenient methods for working with user profiles and is accessible through the ",(0,i.jsx)(t.code,{children:"AuthServices"})," instance."]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-dart",children:"await AuthServices.instance.userProfiles.changeFullName(session, authUserId, 'my name');\n"})}),"\n",(0,i.jsxs)(t.p,{children:["For the full list of operations, see the ",(0,i.jsx)(t.a,{href:"https://pub.dev/documentation/serverpod_auth_core_server/latest/serverpod_auth_core_server/UserProfiles-class.html",children:"UserProfiles"})," class documentation."]}),"\n",(0,i.jsx)(t.h2,{id:"attaching-additional-information",children:"Attaching additional information"}),"\n",(0,i.jsx)(t.p,{children:"The recommended way to attach additional information to an authenticated user is to use a relation in the Database. This makes it easy to query the data later based on the user's authentication identifier."}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-yaml",children:"class: MyDomainData\ntable: my_domain_data\nfields:\n  ### The [AuthUser] this profile belongs to\n  authUser: module:serverpod_auth_core:AuthUser?, relation(onDelete=Cascade)\n  additionalInfo: String\n\nindexes:\n  auth_user_id_unique_idx:\n    fields: authUserId\n    unique: true\n"})}),"\n",(0,i.jsxs)(t.p,{children:["The model above creates a relation to the ",(0,i.jsx)(t.code,{children:"AuthUser"})," table and ensures that each user can only have one ",(0,i.jsx)(t.code,{children:"MyDomainData"})," object. The ",(0,i.jsx)(t.code,{children:"onDelete=Cascade"})," ensures that when the ",(0,i.jsx)(t.code,{children:"AuthUser"})," is deleted, the ",(0,i.jsx)(t.code,{children:"MyDomainData"})," object is also deleted."]}),"\n",(0,i.jsxs)(t.p,{children:["This makes it easy to query the additional information later based on the user's ",(0,i.jsx)(t.code,{children:"authId"}),"."]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-dart",children:"final authUserId = session.authenticated?.authUserId;\nfinal additionalInfo = await MyDomainData.db.findFirstRow(\n    session,\n    where: (t) => t.authUserId.equals(authUserId!),\n);\n"})})]})}function l(e={}){const{wrapper:t}={...(0,r.R)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(h,{...e})}):h(e)}},28453:(e,t,s)=>{s.d(t,{R:()=>a,x:()=>o});var n=s(96540);const i={},r=n.createContext(i);function a(e){const t=n.useContext(r);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:a(e.components),n.createElement(r.Provider,{value:t},e.children)}}}]);