"use strict";(globalThis.webpackChunkserverpod_docs=globalThis.webpackChunkserverpod_docs||[]).push([[42293],{79932(e,i,n){n.r(i),n.d(i,{assets:()=>c,contentTitle:()=>a,default:()=>h,frontMatter:()=>s,metadata:()=>t,toc:()=>d});const t=JSON.parse('{"id":"concepts/authentication/providers/firebase/configuration","title":"Configuration","description":"This page covers configuration options for the Firebase identity provider beyond the basic setup.","source":"@site/versioned_docs/version-3.2.0/06-concepts/11-authentication/04-providers/05-firebase/02-configuration.md","sourceDirName":"06-concepts/11-authentication/04-providers/05-firebase","slug":"/concepts/authentication/providers/firebase/configuration","permalink":"/concepts/authentication/providers/firebase/configuration","draft":false,"unlisted":false,"editUrl":"https://github.com/serverpod/serverpod_docs/tree/main/versioned_docs/version-3.2.0/06-concepts/11-authentication/04-providers/05-firebase/02-configuration.md","tags":[],"version":"3.2.0","sidebarPosition":2,"frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Setup","permalink":"/concepts/authentication/providers/firebase/setup"},"next":{"title":"Customizing the UI","permalink":"/concepts/authentication/providers/firebase/customizing-the-ui"}}');var o=n(74848),r=n(28453);const s={},a="Configuration",c={},d=[{value:"Configuration options",id:"configuration-options",level:2},{value:"Loading Firebase Credentials",id:"loading-firebase-credentials",level:3},{value:"Custom Account Validation",id:"custom-account-validation",level:3},{value:"FirebaseAccountDetails",id:"firebaseaccountdetails",level:3}];function l(e){const i={admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,r.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(i.header,{children:(0,o.jsx)(i.h1,{id:"configuration",children:"Configuration"})}),"\n",(0,o.jsx)(i.p,{children:"This page covers configuration options for the Firebase identity provider beyond the basic setup."}),"\n",(0,o.jsx)(i.h2,{id:"configuration-options",children:"Configuration options"}),"\n",(0,o.jsxs)(i.p,{children:["Below is a non-exhaustive list of some of the most common configuration options. For more details on all options, check the ",(0,o.jsx)(i.code,{children:"FirebaseIdpConfig"})," in-code documentation."]}),"\n",(0,o.jsx)(i.h3,{id:"loading-firebase-credentials",children:"Loading Firebase Credentials"}),"\n",(0,o.jsx)(i.p,{children:"You can load Firebase service account credentials in several ways:"}),"\n",(0,o.jsx)(i.p,{children:(0,o.jsx)(i.strong,{children:"From JSON string (recommended for production):"})}),"\n",(0,o.jsx)(i.pre,{children:(0,o.jsx)(i.code,{className:"language-dart",children:"final firebaseIdpConfig = FirebaseIdpConfig(\n  credentials: FirebaseServiceAccountCredentials.fromJsonString(\n    pod.getPassword('firebaseServiceAccountKey')!,\n  ),\n);\n"})}),"\n",(0,o.jsx)(i.p,{children:(0,o.jsx)(i.strong,{children:"From JSON file:"})}),"\n",(0,o.jsx)(i.pre,{children:(0,o.jsx)(i.code,{className:"language-dart",children:"import 'dart:io';\n\nfinal firebaseIdpConfig = FirebaseIdpConfig(\n  credentials: FirebaseServiceAccountCredentials.fromJsonFile(\n    File('config/firebase_service_account_key.json'),\n  ),\n);\n"})}),"\n",(0,o.jsx)(i.p,{children:(0,o.jsx)(i.strong,{children:"From JSON map:"})}),"\n",(0,o.jsx)(i.pre,{children:(0,o.jsx)(i.code,{className:"language-dart",children:"final firebaseIdpConfig = FirebaseIdpConfig(\n  credentials: FirebaseServiceAccountCredentials.fromJson({\n    'type': 'service_account',\n    'project_id': 'your-project-id',\n    'private_key_id': '...',\n    'private_key': '-----BEGIN PRIVATE KEY-----\\n...\\n-----END PRIVATE KEY-----\\n',\n    'client_email': 'firebase-adminsdk-xxxxx@your-project-id.iam.gserviceaccount.com',\n    'client_id': '...',\n    'auth_uri': 'https://accounts.google.com/o/oauth2/auth',\n    'token_uri': 'https://oauth2.googleapis.com/token',\n  }),\n);\n"})}),"\n",(0,o.jsx)(i.h3,{id:"custom-account-validation",children:"Custom Account Validation"}),"\n",(0,o.jsx)(i.p,{children:"You can customize the validation for Firebase account details before allowing sign-in. By default, the validation requires the email to be verified when present (phone-only authentication is allowed)."}),"\n",(0,o.jsx)(i.p,{children:"The default validation logic:"}),"\n",(0,o.jsx)(i.pre,{children:(0,o.jsx)(i.code,{className:"language-dart",children:"static void validateFirebaseAccountDetails(\n  final FirebaseAccountDetails accountDetails,\n) {\n  // Firebase accounts may not have email if using phone auth\n  // Only validate verifiedEmail if email is present\n  if (accountDetails.email != null && accountDetails.verifiedEmail != true) {\n    throw FirebaseUserInfoMissingDataException();\n  }\n}\n"})}),"\n",(0,o.jsxs)(i.p,{children:["To customize validation, provide your own ",(0,o.jsx)(i.code,{children:"firebaseAccountDetailsValidation"})," function:"]}),"\n",(0,o.jsx)(i.pre,{children:(0,o.jsx)(i.code,{className:"language-dart",children:"final firebaseIdpConfig = FirebaseIdpConfig(\n  credentials: FirebaseServiceAccountCredentials.fromJsonString(\n    pod.getPassword('firebaseServiceAccountKey')!,\n  ),\n  firebaseAccountDetailsValidation: (accountDetails) {\n    // Require verified email (even for phone auth)\n    if (accountDetails.verifiedEmail != true) {\n      throw Exception('Email must be verified');\n    }\n\n    // Restrict to specific email domain\n    if (accountDetails.email != null &&\n        !accountDetails.email!.endsWith('@example.com')) {\n      throw Exception('Only @example.com emails allowed');\n    }\n  },\n);\n"})}),"\n",(0,o.jsx)(i.h3,{id:"firebaseaccountdetails",children:"FirebaseAccountDetails"}),"\n",(0,o.jsxs)(i.p,{children:["The ",(0,o.jsx)(i.code,{children:"firebaseAccountDetailsValidation"})," callback receives a ",(0,o.jsx)(i.code,{children:"FirebaseAccountDetails"})," record with the following properties:"]}),"\n",(0,o.jsxs)(i.table,{children:[(0,o.jsx)(i.thead,{children:(0,o.jsxs)(i.tr,{children:[(0,o.jsx)(i.th,{children:"Property"}),(0,o.jsx)(i.th,{children:"Type"}),(0,o.jsx)(i.th,{children:"Description"})]})}),(0,o.jsxs)(i.tbody,{children:[(0,o.jsxs)(i.tr,{children:[(0,o.jsx)(i.td,{children:(0,o.jsx)(i.code,{children:"userIdentifier"})}),(0,o.jsx)(i.td,{children:(0,o.jsx)(i.code,{children:"String"})}),(0,o.jsx)(i.td,{children:"The Firebase user's unique identifier (UID)"})]}),(0,o.jsxs)(i.tr,{children:[(0,o.jsx)(i.td,{children:(0,o.jsx)(i.code,{children:"email"})}),(0,o.jsx)(i.td,{children:(0,o.jsx)(i.code,{children:"String?"})}),(0,o.jsx)(i.td,{children:"The user's email address (null for phone-only auth)"})]}),(0,o.jsxs)(i.tr,{children:[(0,o.jsx)(i.td,{children:(0,o.jsx)(i.code,{children:"fullName"})}),(0,o.jsx)(i.td,{children:(0,o.jsx)(i.code,{children:"String?"})}),(0,o.jsx)(i.td,{children:"The user's display name from Firebase"})]}),(0,o.jsxs)(i.tr,{children:[(0,o.jsx)(i.td,{children:(0,o.jsx)(i.code,{children:"image"})}),(0,o.jsx)(i.td,{children:(0,o.jsx)(i.code,{children:"Uri?"})}),(0,o.jsx)(i.td,{children:"URL to the user's profile image"})]}),(0,o.jsxs)(i.tr,{children:[(0,o.jsx)(i.td,{children:(0,o.jsx)(i.code,{children:"verifiedEmail"})}),(0,o.jsx)(i.td,{children:(0,o.jsx)(i.code,{children:"bool?"})}),(0,o.jsx)(i.td,{children:"Whether the email is verified"})]}),(0,o.jsxs)(i.tr,{children:[(0,o.jsx)(i.td,{children:(0,o.jsx)(i.code,{children:"phone"})}),(0,o.jsx)(i.td,{children:(0,o.jsx)(i.code,{children:"String?"})}),(0,o.jsx)(i.td,{children:"The user's phone number (for phone auth)"})]})]})]}),"\n",(0,o.jsx)(i.p,{children:"Example of accessing these properties:"}),"\n",(0,o.jsx)(i.pre,{children:(0,o.jsx)(i.code,{className:"language-dart",children:"firebaseAccountDetailsValidation: (accountDetails) {\n  print('Firebase UID: ${accountDetails.userIdentifier}');\n  print('Email: ${accountDetails.email}');\n  print('Email verified: ${accountDetails.verifiedEmail}');\n  print('Display name: ${accountDetails.fullName}');\n  print('Profile image: ${accountDetails.image}');\n  print('Phone: ${accountDetails.phone}');\n\n  // Custom validation logic\n  if (accountDetails.email == null && accountDetails.phone == null) {\n    throw Exception('Either email or phone is required');\n  }\n},\n"})}),"\n",(0,o.jsx)(i.admonition,{type:"info",children:(0,o.jsxs)(i.p,{children:["The properties available depend on the Firebase authentication method used. For example, ",(0,o.jsx)(i.code,{children:"phone"})," is only populated for phone authentication, and ",(0,o.jsx)(i.code,{children:"email"})," may be null if the user signed in with phone only."]})})]})}function h(e={}){const{wrapper:i}={...(0,r.R)(),...e.components};return i?(0,o.jsx)(i,{...e,children:(0,o.jsx)(l,{...e})}):l(e)}},28453(e,i,n){n.d(i,{R:()=>s,x:()=>a});var t=n(96540);const o={},r=t.createContext(o);function s(e){const i=t.useContext(r);return t.useMemo((function(){return"function"==typeof e?e(i):{...i,...e}}),[i,e])}function a(e){let i;return i=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:s(e.components),t.createElement(r.Provider,{value:i},e.children)}}}]);