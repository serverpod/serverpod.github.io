"use strict";(self.webpackChunkserverpod_docs=self.webpackChunkserverpod_docs||[]).push([[92725],{33129:(e,o,n)=>{n.r(o),n.d(o,{assets:()=>a,contentTitle:()=>r,default:()=>g,frontMatter:()=>c,metadata:()=>i,toc:()=>l});const i=JSON.parse('{"id":"concepts/authentication/providers/google/configuration","title":"Configuration","description":"This page covers configuration options for the Google identity provider beyond the basic setup.","source":"@site/versioned_docs/version-3.0.0/06-concepts/11-authentication/04-providers/02-google/02-configuration.md","sourceDirName":"06-concepts/11-authentication/04-providers/02-google","slug":"/concepts/authentication/providers/google/configuration","permalink":"/concepts/authentication/providers/google/configuration","draft":false,"unlisted":false,"editUrl":"https://github.com/serverpod/serverpod_docs/tree/main/versioned_docs/version-3.0.0/06-concepts/11-authentication/04-providers/02-google/02-configuration.md","tags":[],"version":"3.0.0","sidebarPosition":2,"frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Setup","permalink":"/concepts/authentication/providers/google/setup"},"next":{"title":"Customizing the UI","permalink":"/concepts/authentication/providers/google/customizing-the-ui"}}');var t=n(74848),s=n(28453);const c={},r="Configuration",a={},l=[{value:"Configuration options",id:"configuration-options",level:2},{value:"Loading Google Client Secret",id:"loading-google-client-secret",level:3},{value:"Custom Account Validation",id:"custom-account-validation",level:3},{value:"Accessing Google APIs",id:"accessing-google-apis",level:3},{value:"Accessing Google APIs on the Server",id:"accessing-google-apis-on-the-server",level:3}];function d(e){const o={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(o.header,{children:(0,t.jsx)(o.h1,{id:"configuration",children:"Configuration"})}),"\n",(0,t.jsx)(o.p,{children:"This page covers configuration options for the Google identity provider beyond the basic setup."}),"\n",(0,t.jsx)(o.h2,{id:"configuration-options",children:"Configuration options"}),"\n",(0,t.jsxs)(o.p,{children:["Below is a non-exhaustive list of some of the most common configuration options. For more details on all options, check the ",(0,t.jsx)(o.code,{children:"GoogleIdpConfig"})," in-code documentation."]}),"\n",(0,t.jsx)(o.h3,{id:"loading-google-client-secret",children:"Loading Google Client Secret"}),"\n",(0,t.jsx)(o.p,{children:"You can load the Google client secret in several ways:"}),"\n",(0,t.jsx)(o.p,{children:(0,t.jsx)(o.strong,{children:"From JSON string (recommended for production):"})}),"\n",(0,t.jsx)(o.pre,{children:(0,t.jsx)(o.code,{className:"language-dart",children:"final googleIdpConfig = GoogleIdpConfig(\n  clientSecret: GoogleClientSecret.fromJsonString(\n    pod.getPassword('googleClientSecret')!,\n  ),\n);\n"})}),"\n",(0,t.jsx)(o.p,{children:(0,t.jsx)(o.strong,{children:"From JSON file:"})}),"\n",(0,t.jsx)(o.pre,{children:(0,t.jsx)(o.code,{className:"language-dart",children:"final googleIdpConfig = GoogleIdpConfig(\n  clientSecret: GoogleClientSecret.fromJsonFile(\n    File('config/google_client_secret.json'),\n  ),\n);\n"})}),"\n",(0,t.jsx)(o.p,{children:(0,t.jsx)(o.strong,{children:"From JSON map:"})}),"\n",(0,t.jsx)(o.pre,{children:(0,t.jsx)(o.code,{className:"language-dart",children:"final googleIdpConfig = GoogleIdpConfig(\n  clientSecret: GoogleClientSecret.fromJson({\n    'web': {\n      'client_id': 'your-client-id.apps.googleusercontent.com',\n      'client_secret': 'your-client-secret',\n      'redirect_uris': [\n        'http://localhost:8080/auth/google/callback',\n      ],\n    },\n  }),\n);\n"})}),"\n",(0,t.jsx)(o.h3,{id:"custom-account-validation",children:"Custom Account Validation"}),"\n",(0,t.jsxs)(o.p,{children:["You can customize the validation for Google account details before allowing sign-in. By default, the validation checks that the received account details contains ",(0,t.jsx)(o.code,{children:"name"}),", ",(0,t.jsx)(o.code,{children:"fullName"}),", and ",(0,t.jsx)(o.code,{children:"verifiedEmail"})," set to true."]}),"\n",(0,t.jsx)(o.pre,{children:(0,t.jsx)(o.code,{className:"language-dart",children:"final googleIdpConfig = GoogleIdpConfigFromPasswords(\n  // Optional: Custom validation for Google account details\n  googleAccountDetailsValidation: (accountDetails) {\n    // Throw an exception if account doesn't meet custom requirements\n    if (accountDetails.verifiedEmail != true ||\n        !accountDetails.email!.endsWith('@example.com')) {\n      throw GoogleUserInfoMissingDataException();\n    }\n  },\n);\n"})}),"\n",(0,t.jsx)(o.h3,{id:"accessing-google-apis",children:"Accessing Google APIs"}),"\n",(0,t.jsx)(o.p,{children:"The default setup allows access to basic user information, such as email, profile image, and name. You may require additional access scopes, such as accessing a user's calendar, contacts, or files. To do this, you will need to:"}),"\n",(0,t.jsxs)(o.ul,{children:["\n",(0,t.jsx)(o.li,{children:"Add the required scopes to the OAuth consent screen."}),"\n",(0,t.jsxs)(o.li,{children:["Request access to the scopes when signing in. Do this by setting the ",(0,t.jsx)(o.code,{children:"scopes"})," parameter of the ",(0,t.jsx)(o.code,{children:"GoogleSignInWidget"})," or ",(0,t.jsx)(o.code,{children:"GoogleAuthController"}),"."]}),"\n"]}),"\n",(0,t.jsxs)(o.p,{children:["A full list of available scopes can be found ",(0,t.jsx)(o.a,{href:"https://developers.google.com/identity/protocols/oauth2/scopes",children:"here"}),"."]}),"\n",(0,t.jsx)(o.admonition,{type:"info",children:(0,t.jsx)(o.p,{children:"Adding additional scopes may require approval by Google. On the OAuth consent screen, you can see which of your scopes are considered sensitive."})}),"\n",(0,t.jsx)(o.h3,{id:"accessing-google-apis-on-the-server",children:"Accessing Google APIs on the Server"}),"\n",(0,t.jsxs)(o.p,{children:["On the server side, you can access Google APIs using the access token. The ",(0,t.jsx)(o.code,{children:"getExtraGoogleInfoCallback"})," in ",(0,t.jsx)(o.code,{children:"GoogleIdpConfig"})," receives the access token and can be used to call Google APIs:"]}),"\n",(0,t.jsx)(o.pre,{children:(0,t.jsx)(o.code,{className:"language-dart",children:"import 'package:http/http.dart' as http;\n\nfinal googleIdpConfig = GoogleIdpConfigFromPasswords(\n  // Optional: Extract additional info from Google APIs\n  getExtraGoogleInfoCallback: (session, {\n    required accountDetails,\n    required accessToken,\n    required transaction,\n  }) async {\n    // Use accessToken to call Google APIs and store additional info\n    // Example: Access YouTube API\n    final response = await http.get(\n      Uri.https('www.googleapis.com', '/youtube/v3/channels?part=snippet&mine=true'),\n      headers: {'Authorization': 'Bearer $accessToken'},\n    );\n    // Process response and store additional info in the database\n  },\n);\n"})})]})}function g(e={}){const{wrapper:o}={...(0,s.R)(),...e.components};return o?(0,t.jsx)(o,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},28453:(e,o,n)=>{n.d(o,{R:()=>c,x:()=>r});var i=n(96540);const t={},s=i.createContext(t);function c(e){const o=i.useContext(s);return i.useMemo((function(){return"function"==typeof e?e(o):{...o,...e}}),[o,e])}function r(e){let o;return o=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:c(e.components),i.createElement(s.Provider,{value:o},e.children)}}}]);