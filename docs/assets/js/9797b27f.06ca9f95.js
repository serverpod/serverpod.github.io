"use strict";(globalThis.webpackChunkserverpod_docs=globalThis.webpackChunkserverpod_docs||[]).push([[45216],{43448(e,n,i){i.r(n),i.d(n,{assets:()=>r,contentTitle:()=>c,default:()=>h,frontMatter:()=>a,metadata:()=>o,toc:()=>d});const o=JSON.parse('{"id":"concepts/authentication/providers/facebook/configuration","title":"Configuration","description":"This page covers configuration options for the Facebook identity provider beyond the basic setup.","source":"@site/docs/06-concepts/11-authentication/04-providers/08-facebook/02-configuration.md","sourceDirName":"06-concepts/11-authentication/04-providers/08-facebook","slug":"/concepts/authentication/providers/facebook/configuration","permalink":"/next/concepts/authentication/providers/facebook/configuration","draft":false,"unlisted":false,"editUrl":"https://github.com/serverpod/serverpod_docs/tree/main/docs/06-concepts/11-authentication/04-providers/08-facebook/02-configuration.md","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Setup","permalink":"/next/concepts/authentication/providers/facebook/setup"},"next":{"title":"Customizing the UI","permalink":"/next/concepts/authentication/providers/facebook/customizing-the-ui"}}');var s=i(74848),t=i(28453);const a={},c="Configuration",r={},d=[{value:"Configuration options",id:"configuration-options",level:2},{value:"Custom account validation",id:"custom-account-validation",level:3},{value:"FacebookAccountDetails",id:"facebookaccountdetails",level:3},{value:"Accessing Facebook APIs",id:"accessing-facebook-apis",level:3},{value:"Accessing Facebook APIs on the server",id:"accessing-facebook-apis-on-the-server",level:3},{value:"Configuring Facebook Sign-In on the app",id:"configuring-facebook-sign-in-on-the-app",level:2},{value:"Passing configuration in code",id:"passing-configuration-in-code",level:3},{value:"Using environment variables",id:"using-environment-variables",level:3}];function l(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"configuration",children:"Configuration"})}),"\n",(0,s.jsx)(n.p,{children:"This page covers configuration options for the Facebook identity provider beyond the basic setup."}),"\n",(0,s.jsx)(n.h2,{id:"configuration-options",children:"Configuration options"}),"\n",(0,s.jsxs)(n.p,{children:["Below is a non-exhaustive list of some of the most common configuration options. For more details on all options, check the ",(0,s.jsx)(n.code,{children:"FacebookIdpConfig"})," in-code documentation."]}),"\n",(0,s.jsx)(n.h3,{id:"custom-account-validation",children:"Custom account validation"}),"\n",(0,s.jsx)(n.p,{children:"You can customize the validation for Facebook account details before allowing sign-in. By default, the validation checks that the received account details contain a non-empty userIdentifier."}),"\n",(0,s.jsx)(n.p,{children:"The default validation logic:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-dart",children:"static void validateFacebookAccountDetails(\n  final FacebookAccountDetails accountDetails,\n) {\n  if (accountDetails.userIdentifier.isEmpty) {\n    throw FacebookUserInfoMissingDataException();\n  }\n}\n"})}),"\n",(0,s.jsxs)(n.p,{children:["To customize validation, provide your own ",(0,s.jsx)(n.code,{children:"facebookAccountDetailsValidation"})," function:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-dart",children:"final facebookIdpConfig = FacebookIdpConfigFromPasswords(\n  // Optional: Custom validation for Facebook account details\n  facebookAccountDetailsValidation: (FacebookAccountDetails accountDetails) {\n    // Throw an exception if account doesn't meet custom requirements\n    if (accountDetails.userIdentifier.isEmpty) {\n      throw FacebookUserInfoMissingDataException();\n    }\n    // Example: Require email to be present\n    if (accountDetails.email == null || accountDetails.email!.isEmpty) {\n      throw FacebookUserInfoMissingDataException();\n    }\n  },\n);\n"})}),"\n",(0,s.jsx)(n.admonition,{type:"note",children:(0,s.jsx)(n.p,{children:"Users may choose not to share their email or other information during the Facebook login flow. Adjust your validation function carefully to avoid blocking legitimate users."})}),"\n",(0,s.jsx)(n.h3,{id:"facebookaccountdetails",children:"FacebookAccountDetails"}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:"facebookAccountDetailsValidation"})," callback receives a ",(0,s.jsx)(n.code,{children:"FacebookAccountDetails"})," record with the following properties:"]}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Property"}),(0,s.jsx)(n.th,{children:"Type"}),(0,s.jsx)(n.th,{children:"Description"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"userIdentifier"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"String"})}),(0,s.jsx)(n.td,{children:"The Facebook user's unique identifier (UID)"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"email"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"String?"})}),(0,s.jsx)(n.td,{children:"The user's email address (may be null)"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"name"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"String?"})}),(0,s.jsx)(n.td,{children:"The user's display name from Facebook"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"image"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"Uri?"})}),(0,s.jsx)(n.td,{children:"URL to the user's profile image"})]})]})]}),"\n",(0,s.jsx)(n.p,{children:"Example of accessing these properties:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-dart",children:"facebookAccountDetailsValidation: (accountDetails) {\n  print('Facebook UID: ${accountDetails.userIdentifier}');\n  print('Email: ${accountDetails.email}');\n  print('Display name: ${accountDetails.name}');\n  print('Profile image: ${accountDetails.image}');\n\n  // Custom validation logic\n  if (accountDetails.email == null) {\n    // Handle case where user didn't share email\n  }\n},\n"})}),"\n",(0,s.jsx)(n.admonition,{type:"info",children:(0,s.jsx)(n.p,{children:"The properties available depend on the permissions requested and what the user consented to share."})}),"\n",(0,s.jsx)(n.h3,{id:"accessing-facebook-apis",children:"Accessing Facebook APIs"}),"\n",(0,s.jsxs)(n.p,{children:["The default setup allows access to basic user information, such as ",(0,s.jsx)(n.code,{children:"name"})," and ",(0,s.jsx)(n.code,{children:"email"}),". You may require additional permissions to access other Facebook APIs, such as accessing a user's friends, posts, or pages."]}),"\n",(0,s.jsx)(n.p,{children:"The default permissions requested are:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"email"}),": Access to user's email address."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"public_profile"}),": Access to user's basic profile information."]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"To request additional permissions, you will need to:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Ensure the required permissions are configured in your Facebook App settings (navigate to ",(0,s.jsx)(n.strong,{children:"Use cases"})," > ",(0,s.jsx)(n.strong,{children:"Customize"})," > ",(0,s.jsx)(n.strong,{children:"Permissions and features"})," in the ",(0,s.jsx)(n.a,{href:"https://developers.facebook.com/",children:"Facebook App Dashboard"}),")."]}),"\n",(0,s.jsxs)(n.li,{children:["Request access to the permissions when signing in. Do this by setting the ",(0,s.jsx)(n.code,{children:"permissions"})," parameter of the ",(0,s.jsx)(n.code,{children:"FacebookSignInWidget"})," or ",(0,s.jsx)(n.code,{children:"FacebookAuthController"}),"."]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["A full list of available permissions can be found in the ",(0,s.jsx)(n.a,{href:"https://developers.facebook.com/docs/permissions",children:"Facebook permissions reference"}),"."]}),"\n",(0,s.jsx)(n.admonition,{type:"info",children:(0,s.jsx)(n.p,{children:"Adding additional permissions may require App Review depending on the sensitivity of the requested permissions and your app's use case."})}),"\n",(0,s.jsx)(n.h3,{id:"accessing-facebook-apis-on-the-server",children:"Accessing Facebook APIs on the server"}),"\n",(0,s.jsxs)(n.p,{children:["On the server side, you can access Facebook APIs using the access token. The ",(0,s.jsx)(n.code,{children:"getExtraFacebookInfoCallback"})," in ",(0,s.jsx)(n.code,{children:"FacebookIdpConfig"})," receives the access token and can be used to call Facebook Graph APIs:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-dart",children:"import 'package:http/http.dart' as http;\n\nfinal facebookIdpConfig = FacebookIdpConfigFromPasswords(\n  // Optional: Extract additional info from Facebook Graph APIs\n  getExtraFacebookInfoCallback: (session, {\n    required accountDetails,\n    required accessToken,\n    required transaction,\n  }) async {\n    // Use accessToken to call Facebook Graph APIs and store additional info\n    // Example: Access user's friends list\n    final response = await http.get(\n      Uri.https('graph.facebook.com', '/v21.0/me/friends'),\n      headers: {'Authorization': 'Bearer $accessToken'},\n    );\n    // Process response and store additional info in the database\n  },\n);\n"})}),"\n",(0,s.jsx)(n.h2,{id:"configuring-facebook-sign-in-on-the-app",children:"Configuring Facebook Sign-In on the app"}),"\n",(0,s.jsxs)(n.p,{children:["When using the external ",(0,s.jsx)(n.code,{children:"serverpod_auth_idp_flutter_facebook"})," package, you can configure the App ID in your Flutter application."]}),"\n",(0,s.jsx)(n.h3,{id:"passing-configuration-in-code",children:"Passing configuration in code"}),"\n",(0,s.jsx)(n.p,{children:"You can pass the App ID directly when initializing the Facebook Sign-In service:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-dart",children:"await client.auth.initializeFacebookSignIn(\n  appId: 'YOUR_FACEBOOK_APP_ID',\n);\n"})}),"\n",(0,s.jsxs)(n.p,{children:["If the ",(0,s.jsx)(n.code,{children:"appId"})," value is not supplied when initializing the service, the provider will automatically fetch it from the ",(0,s.jsx)(n.code,{children:"FACEBOOK_APP_ID"})," environment variable. This approach is useful for different configurations per platform or build environment."]}),"\n",(0,s.jsx)(n.h3,{id:"using-environment-variables",children:"Using environment variables"}),"\n",(0,s.jsxs)(n.p,{children:["Alternatively, you can pass the App ID during build time using the ",(0,s.jsx)(n.code,{children:"--dart-define"})," option. The Facebook Sign-In provider supports the following environment variable:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"FACEBOOK_APP_ID"}),": Your Facebook App ID."]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Example usage:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'flutter run -d <device> \\\n  --dart-define="FACEBOOK_APP_ID=your_app_id"\n'})}),"\n",(0,s.jsx)(n.p,{children:"This approach is useful when you need to:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Manage separate App IDs for different platforms (Android, iOS, Web, macOS) in a centralized way."}),"\n",(0,s.jsx)(n.li,{children:"Avoid committing App IDs to version control."}),"\n",(0,s.jsx)(n.li,{children:"Configure different credentials for different build environments (development, staging, production)."}),"\n"]}),"\n",(0,s.jsx)(n.admonition,{type:"tip",children:(0,s.jsx)(n.p,{children:"You can also set these environment variables in your IDE's run configuration or CI/CD pipeline to avoid passing them manually each time."})})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(l,{...e})}):l(e)}},28453(e,n,i){i.d(n,{R:()=>a,x:()=>c});var o=i(96540);const s={},t=o.createContext(s);function a(e){const n=o.useContext(t);return o.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:a(e.components),o.createElement(t.Provider,{value:n},e.children)}}}]);