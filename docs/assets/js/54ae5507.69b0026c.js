"use strict";(globalThis.webpackChunkserverpod_docs=globalThis.webpackChunkserverpod_docs||[]).push([[78963],{2950(e,n,t){t.r(n),t.d(n,{assets:()=>d,contentTitle:()=>a,default:()=>p,frontMatter:()=>s,metadata:()=>o,toc:()=>c});const o=JSON.parse('{"id":"concepts/authentication/providers/anonymous/setup","title":"Setup","description":"The Anonymous identity provider is experimental and can not be completely used yet due to the missing support for account linking. The missing parts will be added in the next releases.","source":"@site/docs/06-concepts/11-authentication/04-providers/00-anonymous/01-setup.md","sourceDirName":"06-concepts/11-authentication/04-providers/00-anonymous","slug":"/concepts/authentication/providers/anonymous/setup","permalink":"/next/concepts/authentication/providers/anonymous/setup","draft":false,"unlisted":false,"editUrl":"https://github.com/serverpod/serverpod_docs/tree/main/docs/06-concepts/11-authentication/04-providers/00-anonymous/01-setup.md","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Working with users","permalink":"/next/concepts/authentication/working-with-users"},"next":{"title":"Configuration","permalink":"/next/concepts/authentication/providers/anonymous/configuration"}}');var i=t(74848),r=t(28453);const s={},a="Setup",d={},c=[{value:"Server-side configuration",id:"server-side-configuration",level:2},{value:"Basic configuration options",id:"basic-configuration-options",level:3},{value:"Client-side configuration",id:"client-side-configuration",level:2}];function u(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",p:"p",pre:"pre",strong:"strong",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"setup",children:"Setup"})}),"\n",(0,i.jsx)(n.admonition,{type:"warning",children:(0,i.jsxs)(n.p,{children:["The Anonymous identity provider is ",(0,i.jsx)(n.strong,{children:"experimental"})," and can not be completely used yet due to the missing support for account linking. The missing parts will be added in the next releases."]})}),"\n",(0,i.jsx)(n.p,{children:"To properly configure Anonymous authentication, you must allow anonymous access in your Serverpod auth configuration."}),"\n",(0,i.jsx)(n.admonition,{type:"caution",children:(0,i.jsxs)(n.p,{children:["You need to install the auth module before you continue, see ",(0,i.jsx)(n.a,{href:"../../setup",children:"Setup"}),"."]})}),"\n",(0,i.jsx)(n.h2,{id:"server-side-configuration",children:"Server-side configuration"}),"\n",(0,i.jsxs)(n.p,{children:["In your main ",(0,i.jsx)(n.code,{children:"server.dart"})," file, configure the anonymous identity provider using the ",(0,i.jsx)(n.code,{children:"AnonymousIdpConfig"})," object and add it to your ",(0,i.jsx)(n.code,{children:"pod.initializeAuthServices()"})," configuration:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-dart",children:"import 'package:serverpod/serverpod.dart';\nimport 'package:serverpod_auth_idp_server/core.dart';\nimport 'package:serverpod_auth_idp_server/providers/anonymous.dart';\n\nvoid run(List<String> args) async {\n  final pod = Serverpod(\n    args,\n    Protocol(),\n    Endpoints(),\n  );\n\n  pod.initializeAuthServices(\n    tokenManagerBuilders: [\n      JwtConfigFromPasswords(),\n    ],\n    identityProviderBuilders: [\n      // Configure the Anonymous Identity Provider\n      AnonymousIdpConfig(),\n    ],\n  );\n\n  await pod.start();\n}\n"})}),"\n",(0,i.jsx)(n.p,{children:"Then, extend the abstract endpoint to expose it on the server:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-dart",children:"import 'package:serverpod_auth_idp_server/providers/anonymous.dart';\n\nclass AnonymousIdpEndpoint extends AnonymousIdpBaseEndpoint {}\n"})}),"\n",(0,i.jsxs)(n.p,{children:["Then, run ",(0,i.jsx)(n.code,{children:"serverpod generate"})," to generate the client code and create a migration to initialize the database for the provider. More detailed instructions can be found in the general ",(0,i.jsx)(n.a,{href:"../../setup#identity-providers-configuration",children:"identity providers setup section"}),"."]}),"\n",(0,i.jsx)(n.h3,{id:"basic-configuration-options",children:"Basic configuration options"}),"\n",(0,i.jsxs)(n.p,{children:["Although the Anonymous IDP can be used directly with no other configuration, it is recommended to add some form of app attestation to prevent abuse on production environments. See the ",(0,i.jsx)(n.a,{href:"./configuration#using-a-token-for-app-attestation",children:"Using a token for app attestation section"})," for more details."]}),"\n",(0,i.jsxs)(n.p,{children:["For other configuration options such as callbacks (before/after account creation) and rate limiting, see the ",(0,i.jsx)(n.a,{href:"./configuration",children:"configuration section"}),"."]}),"\n",(0,i.jsx)(n.h2,{id:"client-side-configuration",children:"Client-side configuration"}),"\n",(0,i.jsxs)(n.p,{children:["If you have configured the ",(0,i.jsx)(n.code,{children:"SignInWidget"})," as described in the ",(0,i.jsx)(n.a,{href:"../../setup#present-the-authentication-ui",children:"setup section"}),', the Anonymous identity provider will be automatically detected and displayed in the sign-in widget as a "Continue without account" option.']}),"\n",(0,i.jsxs)(n.p,{children:["You can also use the ",(0,i.jsx)(n.code,{children:"AnonymousSignInWidget"})," to include anonymous sign-in in your own custom UI:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-dart",children:"import 'package:serverpod_auth_idp_flutter/serverpod_auth_idp_flutter.dart';\n\nAnonymousSignInWidget(\n  client: client,\n  onAuthenticated: () {\n    // Do something when the user is authenticated.\n    //\n    // NOTE: You should not navigate to the home screen here, otherwise\n    // the user will have to sign in again every time they open the app.\n  },\n  onError: (error) {\n    // Handle errors\n    ScaffoldMessenger.of(context).showSnackBar(\n      SnackBar(content: Text('Error: $error')),\n    );\n  },\n)\n"})}),"\n",(0,i.jsxs)(n.p,{children:['The widget displays a "Continue without account" button that creates an anonymous session when pressed. For details on customizing the button (size, shape), using a custom widget with ',(0,i.jsx)(n.code,{children:"SignInWidget"}),", or building a fully custom UI with ",(0,i.jsx)(n.code,{children:"AnonymousAuthController"}),", see the ",(0,i.jsx)(n.a,{href:"./customizing-the-ui",children:"customizing the UI section"}),"."]})]})}function p(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(u,{...e})}):u(e)}},28453(e,n,t){t.d(n,{R:()=>s,x:()=>a});var o=t(96540);const i={},r=o.createContext(i);function s(e){const n=o.useContext(r);return o.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:s(e.components),o.createElement(r.Provider,{value:n},e.children)}}}]);