"use strict";(self.webpackChunkserverpod_docs=self.webpackChunkserverpod_docs||[]).push([[82705],{59725:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>d,contentTitle:()=>a,default:()=>h,frontMatter:()=>c,metadata:()=>r,toc:()=>o});const r=JSON.parse('{"id":"upgrading/upgrade-to-three","title":"Upgrade to 3.0","description":"Web Server Changes","source":"@site/docs/08-upgrading/01-upgrade-to-three.md","sourceDirName":"08-upgrading","slug":"/upgrading/upgrade-to-three","permalink":"/next/upgrading/upgrade-to-three","draft":false,"unlisted":false,"editUrl":"https://github.com/serverpod/serverpod_docs/tree/main/docs/08-upgrading/01-upgrade-to-three.md","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Community-supported deployments","permalink":"/next/deployments/community-supported-deployments"},"next":{"title":"Upgrade from Mini to full","permalink":"/next/upgrading/upgrade-from-mini"}}');var i=n(74848),s=n(28453);const c={},a="Upgrade to 3.0",d={},o=[{value:"Web Server Changes",id:"web-server-changes",level:2},{value:"Widget Class Naming Updates",id:"widget-class-naming-updates",level:3},{value:"Static Route Updates",id:"static-route-updates",level:3}];function l(e){const t={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(t.header,{children:(0,i.jsx)(t.h1,{id:"upgrade-to-30",children:"Upgrade to 3.0"})}),"\n",(0,i.jsx)(t.h2,{id:"web-server-changes",children:"Web Server Changes"}),"\n",(0,i.jsx)(t.h3,{id:"widget-class-naming-updates",children:"Widget Class Naming Updates"}),"\n",(0,i.jsx)(t.p,{children:"In Serverpod 3.0, the web server widget classes have been reorganized for better clarity:"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:["The old ",(0,i.jsx)(t.code,{children:"Widget"})," class (for template-based widgets) has been renamed to ",(0,i.jsx)(t.code,{children:"TemplateWidget"})]}),"\n",(0,i.jsxs)(t.li,{children:["The old ",(0,i.jsx)(t.code,{children:"AbstractWidget"})," class has been renamed to ",(0,i.jsx)(t.code,{children:"WebWidget"})]}),"\n",(0,i.jsxs)(t.li,{children:["Legacy class names (",(0,i.jsx)(t.code,{children:"Widget"}),", ",(0,i.jsx)(t.code,{children:"AbstractWidget"}),", ",(0,i.jsx)(t.code,{children:"WidgetList"}),", ",(0,i.jsx)(t.code,{children:"WidgetJson"}),", ",(0,i.jsx)(t.code,{children:"WidgetRedirect"}),") are deprecated but still available for backward compatibility"]}),"\n"]}),"\n",(0,i.jsxs)(t.p,{children:["The ",(0,i.jsx)(t.code,{children:"WidgetRoute"})," class remains unchanged and continues to be the base class for web routes."]}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.strong,{children:"Recommended migration:"})}),"\n",(0,i.jsxs)(t.p,{children:["If you're using the old ",(0,i.jsx)(t.code,{children:"Widget"})," class, update to ",(0,i.jsx)(t.code,{children:"TemplateWidget"}),":"]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-dart",children:"// Old (deprecated but still works)\nclass MyPageWidget extends Widget {\n  MyPageWidget({required String title}) : super(name: 'my_page') {\n    values = {'title': title};\n  }\n}\n\n// New (recommended)\nclass MyPageWidget extends TemplateWidget {\n  MyPageWidget({required String title}) : super(name: 'my_page') {\n    values = {'title': title};\n  }\n}\n"})}),"\n",(0,i.jsx)(t.h3,{id:"static-route-updates",children:"Static Route Updates"}),"\n",(0,i.jsxs)(t.p,{children:["The ",(0,i.jsx)(t.code,{children:"RouteStaticDirectory"})," class has been deprecated in favor of ",(0,i.jsx)(t.code,{children:"StaticRoute.directory()"}),":"]}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.strong,{children:"Before:"})}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-dart",children:"pod.webServer.addRoute(\n  RouteStaticDirectory(\n    serverDirectory: 'static',\n    basePath: '/',\n  ),\n  '/static/**',\n);\n"})}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.strong,{children:"After:"})}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-dart",children:"pod.webServer.addRoute(\n  StaticRoute.directory(Directory('static')),\n  '/static/**',\n);\n"})}),"\n",(0,i.jsxs)(t.p,{children:["The new ",(0,i.jsx)(t.code,{children:"StaticRoute"})," provides better cache control options. You can use the built-in static helper methods for common caching scenarios:"]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-dart",children:"// Example with immutable public caching\npod.webServer.addRoute(\n  StaticRoute.directory(\n    Directory('static'),\n    cacheControlFactory: StaticRoute.publicImmutable(maxAge: 3600),\n  ),\n  '/static/**',\n);\n"})}),"\n",(0,i.jsx)(t.p,{children:"Other available cache control factory methods:"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.code,{children:"StaticRoute.public(maxAge: seconds)"})," - Public cache with optional max-age"]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.code,{children:"StaticRoute.publicImmutable(maxAge: seconds)"})," - Public immutable cache with optional max-age"]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.code,{children:"StaticRoute.privateNoCache()"})," - Private cache with no-cache directive"]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.code,{children:"StaticRoute.noStore()"})," - No storage allowed"]}),"\n"]}),"\n",(0,i.jsx)(t.p,{children:"You can also provide a custom factory function:"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-dart",children:"pod.webServer.addRoute(\n  StaticRoute.directory(\n    Directory('static'),\n    cacheControlFactory: (ctx, fileInfo) => CacheControlHeader(\n      publicCache: true,\n      maxAge: 3600,\n      immutable: true,\n    ),\n  ),\n  '/static/**',\n);\n"})})]})}function h(e={}){const{wrapper:t}={...(0,s.R)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(l,{...e})}):l(e)}},28453:(e,t,n)=>{n.d(t,{R:()=>c,x:()=>a});var r=n(96540);const i={},s=r.createContext(i);function c(e){const t=r.useContext(s);return r.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:c(e.components),r.createElement(s.Provider,{value:t},e.children)}}}]);