<!doctype html>
<html class="docs-version-0.9.22" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.17">
<title data-rh="true">Deploying to AWS | Serverpod</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://serverpod.github.io/0.9.22/deployments/deploying-to-aws"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_version" content="0.9.22"><meta data-rh="true" name="docusaurus_tag" content="docs-default-0.9.22"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:version" content="0.9.22"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-0.9.22"><meta data-rh="true" property="og:title" content="Deploying to AWS | Serverpod"><meta data-rh="true" name="description" content="Serverpod makes it easy to deploy your server to AWS using Github and Terraform. Terraform will set up and manage your infrastructure while you use Github actions to manage versions and deployments. Creating your project using serverpod create Serverpod will automatically generate your deployment scripts. The default setup uses a minimal configuration that will fit within the AWS free tier, but you can easily modify the configuration to suit your needs."><meta data-rh="true" property="og:description" content="Serverpod makes it easy to deploy your server to AWS using Github and Terraform. Terraform will set up and manage your infrastructure while you use Github actions to manage versions and deployments. Creating your project using serverpod create Serverpod will automatically generate your deployment scripts. The default setup uses a minimal configuration that will fit within the AWS free tier, but you can easily modify the configuration to suit your needs."><link data-rh="true" rel="icon" href="/img/favicon.png"><link data-rh="true" rel="canonical" href="https://serverpod.github.io/0.9.22/deployments/deploying-to-aws"><link data-rh="true" rel="alternate" href="https://serverpod.github.io/0.9.22/deployments/deploying-to-aws" hreflang="en"><link data-rh="true" rel="alternate" href="https://serverpod.github.io/0.9.22/deployments/deploying-to-aws" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.fec8d2ce.css">
<link rel="preload" href="/assets/js/runtime~main.96a7f7e1.js" as="script">
<link rel="preload" href="/assets/js/main.5a73b045.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function e(e){document.documentElement.setAttribute("data-theme",e)}var t=function(){var e=null;try{e=localStorage.getItem("theme")}catch(e){}return e}();null!==t?e(t):window.matchMedia("(prefers-color-scheme: dark)").matches?e("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,e("light"))}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_ZgBM">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a href="https://serverpod.dev" target="_blank" rel="noopener noreferrer" class="navbar__brand"><div class="navbar__logo"><img src="/img/logo-horizontal.svg" alt="Serverpod Logo" class="themedImage_W2Cr themedImage--light_TfLj"><img src="/img/logo-horizontal-dark.svg" alt="Serverpod Logo" class="themedImage_W2Cr themedImage--dark_oUvU"></div></a><div class="navbar__item dropdown dropdown--hoverable"><a aria-current="page" class="navbar__link" href="/0.9.22">0.9.22</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/next/deployments/deploying-to-aws">Next</a></li><li><a class="dropdown__link" href="/deployments/deploying-to-aws">1.1.0</a></li><li><a class="dropdown__link" href="/1.0.0/deployments/deploying-to-aws">1.0.0</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/0.9.22/deployments/deploying-to-aws">0.9.22</a></li><li><a class="dropdown__link" href="/0.9.21/deployments/deploying-to-aws">0.9.21</a></li><li><a class="dropdown__link" href="/0.9.20/deployments/deploying-to-aws">0.9.20</a></li><li><a class="dropdown__link" href="/0.9.11/deployments/deploying-to-aws">0.9.11</a></li><li><a class="dropdown__link" href="/0.9.10/deployments/deploying-to-aws">0.9.10</a></li><li><a class="dropdown__link" href="/0.9.9/deployments/deploying-to-aws">0.9.9</a></li><li><a class="dropdown__link" href="/0.9.8/deployments/deploying-to-aws">0.9.8</a></li><li><a class="dropdown__link" href="/0.9.7">0.9.7</a></li><li><a class="dropdown__link" href="/0.9.6">0.9.6</a></li><li><a class="dropdown__link" href="/0.9.5">0.9.5</a></li></ul></div></div><div class="navbar__items navbar__items--right"><a href="https://pub.dev/documentation/serverpod/latest/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>API reference<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><a href="https://careers.serverpod.dev/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>Career<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><a href="https://twitter.com/ServerpodDev" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><a href="https://github.com/serverpod/serverpod" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_P2Lg"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_RiI4" type="button"></button><aside class="theme-doc-sidebar-container docSidebarContainer_rKC_"><div class="sidebar_CW9Y"><nav class="menu thin-scrollbar menu_SkdO"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/0.9.22">Get started</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/0.9.22/tutorials">Tutorials &amp; Examples</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/0.9.22/support">Support &amp; community</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/0.9.22/capabilities">Capabilities</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/0.9.22/concepts/working-with-endpoints">Concepts</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/0.9.22/concepts/working-with-endpoints">Working with endpoints</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/0.9.22/concepts/serialization">Serialization</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/0.9.22/concepts/database-communication">Database communication</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/0.9.22/concepts/caching">Caching</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/0.9.22/concepts/logging">Logging</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/0.9.22/concepts/modules">Modules</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/0.9.22/concepts/authentication">Authentication</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/0.9.22/concepts/file-uploads">Uploading files</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/0.9.22/concepts/streams">Streams and messaging</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/0.9.22/concepts/health-checks">Health checks</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/0.9.22/concepts/webserver">Web server</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/0.9.22/concepts/backward-compatibility">Backward compatibility</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/0.9.22/deployments/deploying-to-aws">Deploying Serverpod</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/0.9.22/deployments/deploying-to-aws">Deploying to AWS</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/0.9.22/deployments/general">General notes</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/0.9.22/roadmap">Roadmap</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/0.9.22/contribute">Contribute</a></li></ul></nav></div></aside><main class="docMainContainer_TCnq"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_DM6M"><div class="theme-doc-version-banner alert alert--warning margin-bottom--md" role="alert"><div>This is documentation for <!-- -->Serverpod<!-- --> <b>0.9.22</b>, which is no longer actively maintained.</div><div class="margin-top--md">For up-to-date documentation, see the <b><a href="/deployments/deploying-to-aws">latest version</a></b> (<!-- -->1.1.0<!-- -->).</div></div><div class="docItemContainer_vinB"><article><span class="theme-doc-version-badge badge badge--secondary">Version: 0.9.22</span><div class="tocCollapsible_jdIR theme-doc-toc-mobile tocMobile_TmEX"><button type="button" class="clean-btn tocCollapsibleButton_Fzxq">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Deploying to AWS</h1><p>Serverpod makes it easy to deploy your server to AWS using Github and Terraform. Terraform will set up and manage your infrastructure while you use Github actions to manage versions and deployments. Creating your project using <code>serverpod create</code> Serverpod will automatically generate your deployment scripts. The default setup uses a minimal configuration that will fit within the AWS free tier, but you can easily modify the configuration to suit your needs.</p><div class="admonition admonition-caution alert alert--warning"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>caution</h5></div><div class="admonition-content"><p>Using Serverpod’s AWS deployment may incur costs to your AWS account. Serverpod’s scripts are provided as-is, and we take no responsibility for any unexpected charges for using them.</p></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="prerequisites">Prerequisites<a class="hash-link" href="#prerequisites" title="Direct link to heading">​</a></h2><p>To use the deployment scripts, you will need the following:</p><ol><li>An AWS account. It may take up to 24 hours to get your AWS account up and running.</li><li>AWS CLI, configured with your credentials. <a href="https://docs.aws.amazon.com/cli/latest/userguide/getting-started-install.html" target="_blank" rel="noopener noreferrer">Install AWS CLI</a></li><li>Terraform. <a href="https://learn.hashicorp.com/tutorials/terraform/install-cli?in=terraform/aws-get-started" target="_blank" rel="noopener noreferrer">Install Terraform</a></li><li>Your Serverpod project version controlled on Github.</li></ol><p>If you haven’t used Terraform before, it’s a great idea to go through their tutorial for AWS, as it will give you a basic understanding of how everything fits together. <a href="https://learn.hashicorp.com/collections/terraform/aws-get-started" target="_blank" rel="noopener noreferrer">Get started with Terraform and AWS</a></p><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</h5></div><div class="admonition-content"><p>The top directory created by Serverpod must be the root directory of your Git repository. Otherwise, the deployment scripts won’t work correctly.</p></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="what-will-be-deployed">What will be deployed?<a class="hash-link" href="#what-will-be-deployed" title="Direct link to heading">​</a></h2><p>The deployment scripts will set up everything you need to run your Serverpod, including an autoscaling cluster of servers, load balancers, a Postgres database, Redis, S3 buckets for file uploads, CloudFront, CodeDeploy, DNS records, and SSL certificates. Some of the components are optional, and you will need to opt in. You can also create a second server cluster for a staging environment. The staging servers allow you to test code before you deploy it to the production servers.</p><p>You deploy your configuration with a domain name; the scripts will set up subdomains that provide access to different functions of your deployment:</p><ul><li><em>api.examplepod.com:</em> This is the entry point for your main Serverpod server.</li><li><em>app.examplepod.com:</em> The Serverpod web server. If you prefer to host it on your top domain, and use <em>www</em> as a redirect, you can change this in the main Terraform configuration file.</li><li><em>insights.examplepod.com:</em> Provides access to the Serverpod UI and gets insights from your server while it is running.</li><li><em>database.examplepod.com:</em> This is how you access your database from outside the server.</li><li><em>storage.examplepod.com:</em> Access to public storage used by Serverpod. (This is optional.)</li></ul><h2 class="anchor anchorWithStickyNavbar_mojV" id="set-up-your-domain-name-and-certificates">Set up your domain name and certificates<a class="hash-link" href="#set-up-your-domain-name-and-certificates" title="Direct link to heading">​</a></h2><p>Before deploying your server, you must configure your server’s top domain in AWS. You can register your domain through any registrar, but you need to set up a public hosted zone in Route 53 in AWS.</p><ol><li>Sign in to the AWS console and navigate to <em>Route 53 &gt; Hosted zones</em>.</li><li>Click <em>Create hosted zone</em>.</li><li>Enter your domain name and click <em>Create hosted zone</em>.</li><li>The console will display a number of DNS names for Amazon’s name servers. You will need to have your domain registrar point to these name servers. Depending on your registrar, this process will be slightly different.</li><li>Expand the <em>Hosted zone details</em> and take note of your <em>Hosted zone ID</em> (you will need it in your Terraform configuration later).</li></ol><p><img loading="lazy" alt="AWS hosted zone record" src="/assets/images/1-hosted-zone-28f1f0e1924fc0eef71f65255e5abadb.jpg" width="2190" height="1322"></p><p><em>Finding the domain name servers for your hosted zone.</em></p><p>Next, you need to create two SSL certificates for your domain. Navigate to <em>AWS Certificate Manager</em>. Here it’s important in which regions you create your certificates. We are deploying to <em>Oregon (us-west-2)</em> in this example, but you can deploy to any region.</p><ol><li>In the top-right corner, choose your preferred region, then click the <em>Request</em> button to request a new certificate.</li><li>Choose to request a public certificate.</li><li>For the Fully qualified domain name, enter your domain name.</li><li>Click <em>Add another name to this certificate</em>.</li><li>Enter a wildcard for any subdomain. E.g., *.examplepod.com</li><li>Validate the domain using DNS validation. AWS can automatically create the required entries in Route 53. Just follow the instructions.</li><li>Save the ARN of your newly created certificate (you will need it in your Terraform configuration later).</li></ol><p><img loading="lazy" alt="Request certificate" src="/assets/images/2-request-certificate-4346d8591cbecf2e0a75cf716302bde5.jpg" width="2224" height="1228"></p><p><em>Create a wildcard certificate for your domain.</em></p><p>Finally, you must create a second wildcard certificate in the <em>US East N. Virginia (us-east-1)</em> region. AWS Cloudfront can only access certificates created in the <em>us-east-1</em> region. Change the region, and repeat the steps from when you created your first certificate. Save the ARN of your second certificate.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="configure-github">Configure Github<a class="hash-link" href="#configure-github" title="Direct link to heading">​</a></h2><p>To allow Github to manage deployments to your AWS server cluster, you need to provide it with access keys and our <code>passwords.yaml</code> file from the Serverpod project. You can use the same AWS access keys as you used to configure AWS CLI or generate a new pair.</p><p>Sign in to Github and find your project’s settings. Navigate to <em>Secrets &gt; Actions</em>. Here you need to add three secrets for deployment to work correctly. <code>AWS_ACCESS_KEY_ID</code> and <code>AWS_SECRET_ACCESS_KEY</code> are your AWS credentials. Github also needs access to your <code>config/passwords.yaml</code> file. Copy the contents of the passwords file and add it to <code>SERVERPOD_PASSWORDS</code>.</p><p><img loading="lazy" alt="Github secrets" src="/assets/images/3-github-secrets-240a9bad3b1ed2fceba1f70a630b95e0.jpg" width="1590" height="535"></p><p><em>Your Github Action secrets after they have been configured.</em></p><h2 class="anchor anchorWithStickyNavbar_mojV" id="configure-serverpod">Configure Serverpod<a class="hash-link" href="#configure-serverpod" title="Direct link to heading">​</a></h2><p>You acquired a hosted zone id and two certificate ARNs from AWS in the previous steps. You will need these to configure your Serverpod deployment scripts. You find the Terraform scripts in your server’s <code>aws/terraform</code> folder. Open up the <code>config.auto.fvars</code> file. Most of the file is already configured, including your project’s name. You will need to fill in the variables: <code>hosted_zone_id</code>, <code>top_domain</code>, <code>certificate_arn</code>, and <code>cloudfront_certificate_arn</code>.</p><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</h5></div><div class="admonition-content"><p>If you deploy your servers in a region other than Oregon (us-west-2), you will need to update the <code>instance_ami</code> variable. Instructions are in the configuration file. In addition, you will also need to update the region in your Github deployment file located in <code>.github/workflows/deployment-aws.yml</code>.</p></div></div><p>By default, the Terraform scripts are configured to use a minimal setup to reduce costs for running your Serverpod. You can quickly turn on additional features, such as enabling Redis or adding a staging server by changing values in the script. You can also change these values later and redo the deployment step.</p><p>Finally, to complete your Serverpod configuration, you will need to edit the <code>config/staging.yaml</code> and <code>config/production.yaml</code> files. In these files, you replace the <code>examplepod.com</code> domain with the domain you are using for your server.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="deploy-your-infrastructure">Deploy your infrastructure<a class="hash-link" href="#deploy-your-infrastructure" title="Direct link to heading">​</a></h2><p>Your Serverpod should now be configured and ready to be deployed. Exciting times! Open up a terminal and <code>cd</code> into your server <code>aws/terraform</code> directory. First, you need to add an environment variable so that Terraform can correctly set the password for the Postgres database. You will find the production password for the database in your <code>config/passwords.yaml</code> file.</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx bash"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token builtin class-name">export</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">TF_VAR_DATABASE_PASSWORD_PRODUCTION</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;&lt;MY PRODUCTION PASSWORD&gt;&quot;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>Next, we are ready to initialize Terraform and deploy our server. You will only need to run the <code>terraform init</code> command the first time you deploy the configuration.</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx bash"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">terraform init</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">terraform apply</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>Terraform will now run some checks and make a plan for the deployment. If everything looks good, it will ask you if you are ready to go ahead with the changes. Type <code>yes</code> and hit the return key. Applying the changes can take up to five minutes as AWS creates the different resources needed for your Serverpod.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="create-database-tables">Create database tables<a class="hash-link" href="#create-database-tables" title="Direct link to heading">​</a></h2><p>For your Serverpod to function correctly, you will need to create its required database tables and any tables specific to your setup. The database queries needed to set up your tables can be found in <code>generated/tables-serverpod.pgsql</code> and <code>generated/tables.pgsql</code>. The <code>tables.pgsql</code> file may be empty if you haven’t added any tables to your project. Use your favorite tool to connect to the database (<a href="https://eggerapps.at/postico/" target="_blank" rel="noopener noreferrer">Postico</a> is a good option if you are on a Mac). Connect to <code>database.examplepod.com</code> (replace <code>examplepod.com</code> with your domain); the user is <code>postgres</code>, the port is 5432, and the database is <code>serverpod</code>. Use the production password from the <code>config/password.yaml</code> file.</p><p><img loading="lazy" alt="Github secrets" src="/assets/images/5-database-connect-00662c711e1b21e129568bce78b6c7a5.jpg" width="1590" height="562"></p><p><em>Connect to the database with Postico.</em></p><h1>Deploy your code</h1><p>We now have our servers, load balancers, database, and other required infrastructure. The only missing part is that our code is not yet up and running. There are two ways to deploy the code from our Github project. We can either push the code to a branch called <code>deployment-aws-production</code> or manually trigger the deployment action from the Github webpage.</p><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</h5></div><div class="admonition-content"><p>If you have set up a staging server, you can also push code to a branch called <code>deployment-aws-staging</code>. This will deploy your code to the staging environment.</p></div></div><p>To manually trigger a deployment, navigate to your project on the Github webpage. Click <em>Actions &gt; Deploy to AWS &gt; Run workflow</em>. This will open up a small dialog that allows you to choose which branch you want to use and if you’re going to target the production or staging servers. Next, click <em>Run workflow</em>. This will trigger the action to deploy your code to your Serverpod. Usually, the deployment process takes around 30 seconds to complete.</p><p><img loading="lazy" alt="Request certificate" src="/assets/images/4-github-workflow-e940d1df9f633c77b3c9a619a1949dfd.jpg" width="1590" height="490"></p><p><em>Manually deploy your server with Github actions.</em></p><h2 class="anchor anchorWithStickyNavbar_mojV" id="test-your-deployment">Test your deployment<a class="hash-link" href="#test-your-deployment" title="Direct link to heading">​</a></h2><p>Your Serverpod should now be up and running! To check if everything is working, open up your web browser and go to <code>https://api.examplepod.com</code>. (You should replace your <code>examplepod.com</code> with your own domain name.) If everything is correctly configured, you will get a message similar to this:</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">OK 2022-05-19 14:29:16.974160Z</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="troubleshooting-and-tips-and-tricks">Troubleshooting and tips and tricks<a class="hash-link" href="#troubleshooting-and-tips-and-tricks" title="Direct link to heading">​</a></h2><p>Chances are that if you followed the instructions, you have a Serverpod deployment that you won&#x27;t have to touch very often. However, this section gives you some pointers on where to start looking if things go wrong.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="signing-in-to-your-instances">Signing in to your instances<a class="hash-link" href="#signing-in-to-your-instances" title="Direct link to heading">​</a></h3><p>You can find a list of your currently running EC2 instances by navigating to <em>EC2 &gt; Instances</em>. Click on one of the instances to go to its summary page. From there, click <em>Connect</em>. On the <em>Connect to instance</em> page, click <em>Connect</em>, and AWS will open up a console window with access to your EC2 instance.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="external-dependencies-and-submodules">External dependencies and submodules<a class="hash-link" href="#external-dependencies-and-submodules" title="Direct link to heading">​</a></h3><p>The deployment scripts support using submodules and external dependencies. Place any such dependencies in a directory called <code>vendor</code> at the root of your Github project.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="troubleshooting-deployments">Troubleshooting deployments<a class="hash-link" href="#troubleshooting-deployments" title="Direct link to heading">​</a></h3><p>The deployment process involves a couple of steps. When you trigger a deployment from Github, the action will create a deployment and upload it to an S3 bucket. Then, CodeDeploy on AWS is triggered. You can find the logs from the Github action under the <em>Actions</em> tab of your project. If the deployment process fails later, those logs are available on AWS by navigating to <em>CodeDeploy &gt; Deploy &gt; Deployments</em>.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/serverpod/serverpod_docs/tree/main/versioned_docs/version-0.9.22/05-deployments/01-deploying-to-aws.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_dcUD" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_foO9"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/0.9.22/concepts/backward-compatibility"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Backward compatibility</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/0.9.22/deployments/general"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">General notes</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_cNA8 thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#prerequisites" class="table-of-contents__link toc-highlight">Prerequisites</a></li><li><a href="#what-will-be-deployed" class="table-of-contents__link toc-highlight">What will be deployed?</a></li><li><a href="#set-up-your-domain-name-and-certificates" class="table-of-contents__link toc-highlight">Set up your domain name and certificates</a></li><li><a href="#configure-github" class="table-of-contents__link toc-highlight">Configure Github</a></li><li><a href="#configure-serverpod" class="table-of-contents__link toc-highlight">Configure Serverpod</a></li><li><a href="#deploy-your-infrastructure" class="table-of-contents__link toc-highlight">Deploy your infrastructure</a></li><li><a href="#create-database-tables" class="table-of-contents__link toc-highlight">Create database tables</a></li><li><a href="#test-your-deployment" class="table-of-contents__link toc-highlight">Test your deployment</a></li><li><a href="#troubleshooting-and-tips-and-tricks" class="table-of-contents__link toc-highlight">Troubleshooting and tips and tricks</a><ul><li><a href="#signing-in-to-your-instances" class="table-of-contents__link toc-highlight">Signing in to your instances</a></li><li><a href="#external-dependencies-and-submodules" class="table-of-contents__link toc-highlight">External dependencies and submodules</a></li><li><a href="#troubleshooting-deployments" class="table-of-contents__link toc-highlight">Troubleshooting deployments</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 Serverpod authors.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.96a7f7e1.js"></script>
<script src="/assets/js/main.5a73b045.js"></script>
</body>
</html>